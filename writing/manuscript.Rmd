---
title: "\\Large The heat is on: Rising temperatures alter how and where mammals move"
author:
  - name: Stefano Mezzini
    email: stefano.mezzini@ubc.ca
    institute: [braes, biol]
  - name: Chris H. Fleming
    institute: [ucf, smith]
  - name: Siobhan Darlington
    institute: [braes, biol]
  - name: Adam T. Ford
    institute: [braes, biol]
  - name: TJ Gooliaff
    institute: [forest]
  - name: Karen E. Hodges
    institute: [braes, biol]
  - name: Kirk Safford
    institute: bcp
  - name: Robert Serrouya
    institute: [braes, biol, biodiv]
  - name: Michael J. Noonan
    email: michael.noonan@ubc.ca
    institute: [braes, biol, cmps]
institute:
  - braes: Okanagan Institute for Biodiversity, Resilience, and Ecosystem Services, The University of British Columbia Okanagan, Kelowna, British Columbia, Canada.
  - biol: Department of Biology, The University of British Columbia Okanagan, Kelowna, British Columbia, Canada.
  - ucf: Department of Biology, University of Central Florida, Orlando, Florida 32816, United States.
  - smith: Smithsonian Conservation Biology Institute, National Zoological Park, 1500 Remount Rd., Front Royal, VA 22630, United States.
  - forest: British Columbia Ministry of Forests, Lands, Natural Resource Operations and Rural Development, Penticton, BC, Canada.
  - bcp: British Columbia Ministry of Environment and Parks, Penticton, BC, Canada.
  - biodiv: Wildlife Science Centre, Biodiversity Pathways, University of British Columbia Okanagan, Revelstoke, British Columbia, Canada.
  - cmps: Department of Computer Science, Math, Physics, and Statistics, The University of British Columbia Okanagan, Kelowna, British Columbia, Canada.
bibliography: 'bc-mammals-temperature.bib'
csl: 'global-change-biology.csl'
fontsize: 12pt
indent: true
header-includes:
    - \usepackage{setspace}\doublespacing # for double-spaced text
    - \usepackage{indentfirst} # for indenting first line of each paragraph
    - \usepackage[small]{titlesec} # for smaller font for headings
    - \usepackage{caption} # for more customization of captions
    - \captionsetup[figure]{font=scriptsize, aboveskip=4pt, belowskip=-15pt}
    - \usepackage{hanging} # for hanging indents in references
    - \usepackage[left]{lineno} # for line numbers
    - \usepackage{booktabs} # to prevent tables from splitting
subparagraph: true # needed for \usepackage[small]{titlesec}
urlcolor: cyan
output:
  bookdown::pdf_document2:
    latex_engine: xelatex # for Delta symbol in table
    pandoc_args:
      - '--lua-filter=scholarly-metadata.lua'
      - '--lua-filter=author-info-blocks.lua'
    toc: false
    number_sections: true
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
# set chunk defaults: don't print code, images text width and centered
knitr::opts_chunk$set(echo = FALSE, out.width = '\\textwidth',
                      fig.align = 'center', cache = TRUE, warning = FALSE,
                      message = FALSE)
```

<!--
available text sizes:
Huge > huge > LARGE > Large > large > normalsize > small > footnotesize > scriptsize > tiny
-->

<!--
six-sentence abstract:

1. introduce the topic
2. state the problem
3. summarize why the question hasn't been answered/what the consequences are
4. explain how you answered the question
5. explain the central findings
6. explain the importance of your findings and their consequences
-->

```{r abstract, echo=FALSE}
abstract <- "Widespread warming during the last century has caused many terrestrial mammals to change how and where they move, with cascading effects on fitness, habitat selection, and community structure. Previous studies have estimated the effects of temperature on mammalian movement behaviour, but many did not disentangle them from seasonal behavior cycles. Consequently, it is still unclear how mammals will adapt their movement behavior in the 21^st^ century. We address this gap by using continuous-time movement models and hierarchical generalized additive models to quantify the effects of temperature on the movement rates and habitat selection of six large-bodied mammalian species throughout western Canada between 1998 and 2023. We show that temperature is a strong determinant of how and where mammals move, and we predict that climate change will have significant impacts on mammals' movement rates and habitat selection throughout the 21^st^ century. We found that species did not respond uniformly to rising temperatures, so community-level responses will likely be complex as some species move more and others less. Median habitat selection strength decreased for all species, but some species showed increased selection strength for higher altitudes. Consequently, our results suggest that all six species may shift their range in the coming decades as their selection strength for their current ranges weakens. As climate change exposes mammals to novel environmental conditions, predicting changes in animal behavior and community structure will become crucial for effectively and proactively understanding mammalian movement behavior and protecting high-quality habitat. We thus present our work using a flexible approach that can be adapted for different species and spatiotemporal scales, and we conclude by providing suggestions for future research, with particular attention to the study design, statistical modeling, and forecasting."
if(FALSE){
  stringi::stri_count_words(abstract)
}
```

\clearpage

\noindent \textbf{Article type}: Research article

\noindent \textbf{Words in abstract}: `r stringi::stri_count_words(abstract)`

\noindent \textbf{Words in main text}: `r suppressMessages(wordcountaddin::word_count())`

\noindent \textbf{Figures}: 8

\noindent \textbf{Tables}: 3

\noindent \textbf{References}: 142 (updated on 2025-06-11) <!-- counted by using movement ecology csl -->

\noindent \textbf{Appendices}: 2

<!-- using "behaviOR" in key words to increase audience -->

\noindent \textbf{Key words:} climate change, temperature, mammals, animal movement, movement behavior, habitat selection

\ 

\clearpage

# Abstract {-}

\noindent `r abstract`

<!-- start main body on a new page -->
\newpage

\doublespacing

\linenumbers

```{r packages, warning=FALSE, message=FALSE}
library('dplyr') # for data wrangling
library('purrr') # for data wrangling
library('tidyr') # for data wrangling
library('ctmm')  # for movement models
```

# other refs

* @gerlich_species_2025: effects of temperature on fly movement in the arctic
* "Potential changes in climate indices in Alberta under projected global warming of 1.5â€“5 $^\circ$C" (https://www.sciencedirect.com/science/article/pii/S2214581823000770#fig0015)
* Global vulnerability of marine mammals to global warming: https://doi.org/10.1038/s41598-019-57280-3
* marine turtles shift and lose habitat with temperature: https://www.science.org/doi/10.1126/sciadv.adw4495

\clearpage

# Introduction

<!-- movement is a convenient way to respond to change, but movement depends on temperature -->

\noindent For most animals, movement is a rapid and low-cost response to a variety of stimuli [@nathan_movement_2008]. Animals move to optimize resource use [e.g., food, water, shelter$;$ @charnov_optimal_1976; @kacelnik_ideal_1992; @mezzini_how_2025], optimize habitat use [@winter_forecasting_2024], and avoid predators and competitors [@peterson_pursuit_2021; @bartashevich_collective_2024; @tan_antipredator_2024; @torrez-herrera_monkeys_2020]. However, ambient temperature affects mammals' movement rates by altering the energetic cost of movement [@mcnab_body_1970; @taylor_energetics_1982; @brown_toward_2004; @fuller_towards_2016; @jahn_variations_2022] and the risk of overheating [@hetem_responses_2014; @dyer_travel_2023]. Animals may search for a short-term buffer from extreme heat or cold via thermal refugia [@hannah_fine-grain_2014; @elmore_implications_2017; @attias_effects_2018; @arechavala-lopez_common_2019; @gulland_review_2022], which may even be preferred over forage abundance [@hall_microrefuges_2016].

Temperature also has indirect effects on movement through other drivers of movement behaviour, such as trophic interactions [@hegel_interacting_2010], snow depth and density [@montgomery_movement_2019; @leclerc_determinants_2021; @melin_effect_2023], altered phenology [@bunnell_global_2011; ], and the frequency and intensity of extreme events [@zhang_increased_2023; @bunnell_global_2011], including forest fires, droughts, and extreme weather [@zurowski_summer_2023; @duncan_predicting_2012; @bunnell_global_2011; @merkle_large_2016; @slatyer_ecological_2022; @berger_climate_2018]. Changes in temperature thus affect how animals move [e.g., movement frequency and speed -- their movement behaviour: @nathan_movement_2008; @dyer_travel_2023] and where they move to [i.e., their habitat selection: @merkle_large_2016; @alston_temperature_2020; @giroux_activity_2023].

<!-- since movement depends on temperature, the consequences of movement do, too -->

By impacting animal movement behavior, temperature also affects the consequences of movement, such as encounter rates with resources [@mezzini_how_2025], other animals [@martinez-garcia_how_2020], and humans [@weststrate_how_2024], and these changes are exacerbated at extreme temperatures [@wilson_stenotherms_2001; @berger_climate_2018; @giroux_activity_2023]. But what counts as "extreme" varies across species: Species that experience narrow temperature ranges tend to be more sensitive to changes [e.g., giant anteaters, *Myrmecophaga tridactyla*: @giroux_activity_2023], while thermal generalists can adapt more easily to change [@levins_evolution_1974; @botero_evolutionary_2015; @dupont_beyond_2024]. However, generalists' greater adaptability is tested when they are subject to changes that are more severe [@mccain_assessing_2019], affect many factors [e.g., temperature, phenology, and resource availability: @polazzo_measuring_2024], or are too rapid to respond within the span of a lifetime or a few generations [@levins_evolution_1974; @fuller_towards_2016; @xu_plasticity_2021].

<!-- we do not know how temperature will change -->

In the last 200 years, many ecosystems experienced widespread warming that resulted in milder and shorter winters, hotter and longer summers, and a greater risk of extremely high temperatures [@ipcc_climate_2023]. Over the next 100 years, these changes are expected to worsen and continue to impact mammals' fitness, movement behaviour, and habitat selection as animals cope with growing heat stress [@deb_modelling_2020; @woo-durand_increasing_2020] and more frequent and intense extreme events [@bunnell_global_2011], along with increasing anthropogenic pressure [@sih_evolution_2011; @sawyer_identifying_2009; @weststrate_how_2024]. Consequently, it remains unclear how or whether species will be able to respond to climate change in the current century [@deb_modelling_2020; @woo-durand_increasing_2020; @verzuh_behavioural_2023], especially when populations fail to adapt to changes [@sawyer_migratory_2019; @botero_evolutionary_2015] or are physiologically incapable to do so [@sherwood_adaptability_2010; @williams_range_2018]. Uncertainty in future conditions and their consequences on ecosystems present a need for a comprehensive understanding of (1) the direct effects of temperature on animal movement behaviour and (2) the implications such changes and uncertainty will have on populations and species' adaptability and resiliency, as well as overall community structure. Recent work has documented the effects of climate change on mammals' ranges [@leclerc_determinants_2021], movement behaviour [@melin_effect_2023], thermoregulation [@mota-rojas_physiological_2021], and trait-based responses [e.g., body size, activity time, and elevational and latitudinal distribution @mccain_assessing_2019]. However, it is still unclear how mammals will adapt their small-scale movement and habitat selection to changes in temperature during the 21^st^ century [@ipcc_climate_2023; but see @hetem_responses_2014; @winter_forecasting_2024].

<!-- why is understanding the present and predicting into the future necessary -->

Understanding the direct and indirect impacts of temperature on mammalian movement is essential for decision makers to respond to change in a proactive manner [@sawyer_identifying_2009; @mccain_assessing_2019]. Western Canada is currently experiencing rapid widespread warming [@dierauer_climate_2021; @kienzle_has_2018; @turner_its_2009], phenological shifts [@tysor_countergradient_2025; @basu_phenological_2024; @kienzle_has_2018], and more frequent and intense extreme events [@zhang_increased_2023], including forest fires [@zurowski_summer_2023]. As we approach the deadline for the "30 by 30" conservation initiative, a global effort to conserve 30% of the world's lands and oceans by 2030 [@convention_on_biological_diversity_154_2022], decision makers must understand which areas will be of greatest value for maximizing the project's effectiveness. Predicting how climate change will affect how, when, and where animals will move is necessary for identifying landscape dynamics and value will evolve throughout the century. Failing to understand how changes in temperature will affect mammalian movement behaviour and habitat selection will hinder our ability to respond to the current climate crisis and make decisions that are viable in the long term.

<!-- introduce the study -->

This paper provides a framework for quantifying the effects of proximal air temperature on animal movement using quantitative methods that are flexible and statistically robust. We present results for six large-bodied terrestrial mammal species in western Canada (wolves: *Canis lupus*, elk: *Cervus canadensis*, mountain goats: *Oreamnos americanus*, cougars: *Puma concolor*, boreal and southern mountain caribou: *Rangifer tarandus*, and grizzly bears: *Ursus arctos horribilis*; Table \@ref(tab:data-table)). Using over 25 years of telemetry data throughout a large spatial range of western Canada and hourly air temperature data, we estimate how these mammals altered their probability of movement, speed when moving, and habitat selection in response to temperature. We then pair the estimated responses with climate change projections to forecast the species' movement during the 21^st^ century under different climate-change scenarios [referred to as Shared Socioeconomic Pathways, SSP, @riahi_shared_2017]. We disentangle the direct and indirect effects of temperature on the movement behaviour of terrestrial mammals and discuss the consequences of these changes at the individual, population, and community levels.

```{r bc-map, fig.cap="GPS telemetry data for the six species in this study (dots) over a digital elevation model for the study area.", out.width='0.75\\linewidth'}
knitr::include_graphics('../figures/tels-map-dem.png')
```

\footnotesize

```{r, eval=FALSE}
# a quick check for the table below
readRDS('../data/movement-models-speed-weights-2024-06-10.rds') %>%
  group_by(dataset_name, animal) %>%
  summarize(n = n_distinct(animal),
            any_na_speed = any(is.na(speed_est)),
            all_na_speed = all(is.na(speed_est))) %>%
  group_by(dataset_name) %>%
  summarise(n_missing_any = sum(any_na_speed),
            n_missing_all = sum(all_na_speed))
```

```{r data-table}
dt_data <-
  readRDS('../models/movement-models-2024-06-06.rds') %>%
  transmute(
    Species = case_when(
      dataset_name == 'Canis_lupus_boreal' ~ '\\emph{Canis lupus}',
      dataset_name == 'Rangifer_tarandus_boreal' ~ '\\emph{Rangifer tarandus} (boreal)',
      dataset_name == 'Rangifer_tarandus_southern_mountain' ~ '\\emph{Rangifer tarandus} (s. mountain)',
      dataset_name == 'Puma_concolor_2' ~ '\\emph{Puma concolor}',
      dataset_name == 'Puma_concolor_4' ~ '\\emph{Puma concolor}',
      dataset_name == 'Elk in southwestern Alberta' ~ '\\emph{Cervus canadensis}',
      dataset_name == 'Oreamnos_americanus' ~ '\\emph{Oreamnos americanus}',
      dataset_name == 'Ursus_arctos_horribilis' ~ '\\emph{Ursus arctos horribilis}'),
    animal, # keep animal column for grouping later
    tel = map(tel, data.frame),
    na_speed = map_lgl(movement_model,
                       \(.m) suppressWarnings(speed(.m)$DOF == 0))) %>%
  unnest(tel) %>%
  group_by(Species, animal) %>%
  summarize(Start = min(as.Date(timestamp)),
            End = max(as.Date(timestamp)),
            dt = median(timestamp - lag(timestamp), na.rm = TRUE),
            animal = unique(animal),
            na_speed = unique(na_speed),
            .groups = 'drop') %>%
  group_by(Species) %>%
  summarize(Start = min(Start),
            End = max(End),
            dt = as.numeric(median(dt, na.rm = TRUE)),
            Animals = n_distinct(animal),
            n_missing = sum(! na_speed),
            .groups = 'drop') %>%
  mutate(dt = round('hours' %#% dt, 2)) %>% # convert from seconds to hours
  rename('\U0394t (hours)' = dt,
         'Has speed' = n_missing)

knitr::kable(dt_data, format = 'markdown', caption = 'Start and end of the GPS telemetries along with the median sampling interval ($\\Delta t$; stratified by individual), number of animals (Animals), and number of animals with resolved speed (Has speed) for each of the species in this study.', escape = FALSE, longtable = FALSE, booktabs = TRUE)
```

\normalsize

# Methods

## Datasets used

This study leverages four main datasets: (1) a multi-species collection of GPS telemetry data (Fig. \@ref(fig:bc-map)); (2) historical hourly reanalyzed air temperature from the ERA5 dataset from the European Center for Medium-range Weather Forecasting; (3) resource rasters of percent forest cover, elevation, and distance from water; and (4) climate change projections under four Shared Socioeconomic Pathways [SSPs, see @riahi_shared_2017]. While we acknowledge that forest type, structure, and age are important variables, we do not include such variables in this study for the sake of parsimony and comparability across species. We detail the data sources and analyses in the sections below.

### GPS telemetry data

```{r, eval=FALSE}
tels <- readRDS('data/tracking-data/all-tracking-data-cleaned-2024-02-22-13-49.rds') %>%
  tidyr::unnest(tel)

# all outliers
sum(tels$outlier)
round(mean(tels$outlier) * 100, 2)

# new outliers
sum(tels$outlier & !tels$original_outliers)
round(mean(tels$outlier & !tels$original_outliers) * 100, 2)
```


\noindent Elk (*Cervus canadensis*) data from @ciuti_human_2012 were downloaded from Movebank [study name: Elk in southwestern Alberta, see @kays_movebank_2022], while boreal caribou (*Rangifer tarandus*) and wolf (*Canis lupus*) telemetries were acquired via a public British Columbia Oil and Gas Research and Innovation Society repository ([https://www.bcogris.ca/projects/boreal-caribou-telemetry-data](https://www.bcogris.ca/projects/boreal-caribou-telemetry-data)). ***MISSING INFO ON OTHER TELEMETRY DATA.*** From the full set of telemetry data, a total of 2396 GPS locations (0.16%, including collar calibration data) were removed using diagnostic plots of (1) distance from the median location, (2) straight-line displacement between locations, (3) turning angle, and (4) time interval between consecutive points. Particular attention was paid to points with large turning angles ($\gtrapprox 170^\circ$) and excessively high straight-line displacement, especially if antecedent and subsequent points indicated stationary behaviour (Appendix A).

### Historical temperature data and temperature projections

\noindent Rasters of hourly reanalyzed air temperature data were downloaded from the ERA5 database [@hersbach_era5_2023] from the European Center for Medium-range Weather Forecasting server (ECMWF; [www.ecmwf.int](www.ecmwf.int); [https://cds.climate.copernicus.eu](https://cds.climate.copernicus.eu)). Proximal temperature was estimated for each location by extracting the value from the corresponding raster cell from the temporally nearest raster using the `extract()` function from the `terra` package [version 1.7-46, @hijmans_terra_2023] for `R` [@r_core_team_r_2024].

We obtained rasters of projected monthly average temperature for the study region at a 0.08$^\circ$ spatial resolution from 2020 to 2100 under the different SSPs via the `climatenaR` package [version 1.0, @burnett_climatenar_2023] for `R`. Since the climate projections only provided monthly means and ranges but no measures of variance or distributional assumptions, we used the hourly ERA5 reanalized data for western Canada from 1998 to 2023 [extremes included, @hersbach_era5_2023] to calculate within-month variance in temperature, which we defined as the variance within a given pixel, month, and year. We then modeled the estimated variance using a GAM for location and scale [GAMLS, @rigby_generalized_2005; @stasinopoulos_generalized_2007; section 7.9 in @wood_generalized_2017]. The linear predictor for the location (i.e., the mean) included smooth terms of the within-pixel monthly mean temperature (within each year), month (as a cyclic smooth), a two-dimensional smooth of space, and a tensor interaction product term of space and month. The linear predictor for the scale term (which governs the mean-variance relationship) included smooth terms of the monthly mean, month, and space. We did not include a smooth of year to avoid unrealistic projections when extrapolating beyond the range of historical data.

```{r, eval=FALSE, echo=FALSE}
m_gammals <- gam(list(
  # linear predictor for the mean parameter
  monthly_var ~
    s(monthly_mean, bs = 'cr', k = 10) +
    s(month, bs = 'cc', k = 10) + # using a cyclic cubic spline basis
    s(long, lat, bs = 'ds', k = 500) +
    ti(long, lat, month, bs = c('ds', 'cc'), d = c(2, 1), k = c(100, 10)),
  # linear predictor for the scale parameter
  ~ s(monthly_mean, bs = 'cr', k = 10) +
    s(month, bs = 'cc', k = 10) +
    s(long, lat, bs = 'ds', k = 100)),
  family = gammals(),
  data = d,
  method = 'REML',
  knots = list(month = c(0.5, 12.5)))
```

We simulated hourly variation in future weather by assuming hourly temperature followed a normal distribution with mean specified by the monthly `climatenaR` climate projections and variance as specified by the Gamma GAMLS. For each month within each year from 2020 to 2100, we simulated hourly weather by including temperatures from the 0.1 to the 0.9 quantile by increments of 0.1, and we weighted each quantile proportionally to the (normalized) Gaussian probability density for each quantile.

### Resource rasters

\noindent We estimated percent forest cover and distance from water using the rasters created by @tuanmu_global_2014. We calculated total forest cover by summing the temporally static rasters of evergreen/deciduous needle-leaf trees, evergreen broadleaf trees, deciduous broadleaf trees, and mixed/other trees (raster classes 1-4, respectively). We converted the raster of percent cover of open water (class 12) to a binary raster of pixels with water (cover > 0%) or without water (cover = 0%) and then calculated each pixel's distance from the nearest pixel with water using the `distance()` function from the `terra` package. Finally, we obtained two digital elevation models using the `get_elev_raster()` function from the `elevatr` package [version 0.99.0, @hollister_elevatr_2023]: We used a raster with a zoom of 6 (0.009$^\circ$) for model fitting and one with a zoom of 3 (0.08$^\circ$) for downloading climate change projections via `climatenaR`. All final rasters and code are available on GitHub at [https://github.com/QuantitativeEcologyLab/bc-mammals-temperature](https://github.com/QuantitativeEcologyLab/bc-mammals-temperature).

## Estimating mammals' instantaneous speeds

\noindent We modeled each animal's movement using continuous-time movement models [@fleming_fine-scale_2014] via the `ctmm` package [version 1.2.0, @fleming_ctmm_2023] for `R`. We then estimated mammals' instantaneous speeds by applying the `ctmm::speeds()` function on all models with finite speed estimates [415 of 433, @fleming_fine-scale_2014; @noonan_scale-insensitive_2019]. The 18 animals with insufficiently fine sampling to support movement models with finite speed [@noonan_scale-insensitive_2019] were for one mountain goat, 15 boreal caribou, and 2 southern mountain caribou (Table \@ref(tab:data-table)).

Since `ctmm``s movement models assume stochastic but non-zero speeds (i.e., a single, stochastic moving state), data-informed speeds needed to be corrected so that the minimum instantaneous speed could be 0. We performed this correction by subtracting each model's mean speed while assuming speeds were $\chi^2$-distributed. The function we used is available on GitHub at [https://github.com/QuantitativeEcologyLab/bc-mammals-temperature/blob/main/functions/detrend_speeds.R](https://github.com/QuantitativeEcologyLab/bc-mammals-temperature/blob/main/functions/detrend_speeds.R). To avoid artifacts due to excessively small, non-zero speeds, we determined whether an animal was moving or not using a $k$-means algorithm with 2 clusters for each species' detrended speeds. When the algorithm clearly failed to discriminate between states, we estimated the split point using the inflection points in histograms of the detrended speeds (Fig. B1).

## Estimating the effects of temperature on mammals' movement

\noindent The following sections detail the statistical framework and modelling we used to estimate the effect on temperature on mammals' movement. To assess the importance of including temperature as an explicit covariate (rather than including its effects with time of day and day of year), we fit models with and without smooth effects of temperature and compared the fits of the two sets of models.

### Disentangling direct and indirect effects

\noindent In this study, we separate the effects of temperature on mammalian movement into direct and indirect effects. We call "direct" all effects that impact movement behavior causally without first impacting another variable (Fig. \@ref(fig:dags)). For example, in Fig. \@ref(fig:dags)A, whether a grizzly bear is moving in a given moment directly depends on time of day and day of year, since it will not be moving when sleeping or hibernating. However, time of day and day of year also impact its movement behavior indirectly because its sensitivity to temperature will also depend on time of day and day of year. Thus, both time of day and day of year also impact movement frequency indirectly by altering the effect of temperature on movement frequency. Failing to disentangle the effects of these three variables will lead to incorrect and likely confusing estimates for the causal effect of temperature on movement behavior, since causal and non-causal relationships would be indistinguishable [@mcelreath_statistical_2020].

Indirect effects of temperature also include all effects that can be controlled by altering an animal's habitat [its geographic space *sensu* @matthiopoulos_defining_2022]. For example, in Fig. \@ref(fig:dags)B, an increase in temperature may push an animal to prefer higher forest cover in search of shade, and conservationists can mitigate these indirect effects of temperature by increasing the availability of forested areas, since the effect of temperature on movement is conditional on forest cover availability. In contrast, the animal may avoid moving if temperatures are above 35$^\circ$C, irrespective of its geographic and environmental space [*sensu* @matthiopoulos_defining_2022]. In this case, it is not possible to mitigate the effects of temperature on movement behaviour (other than changing temperature directly).

```{r dags,  message=FALSE, warning=FALSE, fig.cap="Directed Acyclical Graphs (DAGs) assumed for inferring the causal effects of temperature (Temp) on movement behavior. (A) DAG for the probability of moving, speed when moving, or distance traveled ($Y$) while accounting for the effects of time of day (TOD), day of year (DOY), and their interaction effects. Temperature directly affects $Y$, but the effects of temperature depend on the time of day and season. Time of day and day of year also affect $Y$ directly, but the effect of time of day changes throughout the year due to changes in day length and seasonality. (B) DAG for Relative Selection Strength (RSS) for percent forest cover (F), elevation (E), and distance from water (W). The RSS for of a given habitat depends on all three resources, and the selection for each resource is independent of the other two resources and dependent on temperature.", fig.height=4, fig.width=10, out.width='\\linewidth'}
library('dplyr')   # for data wrangling
library('ggplot2') # for fancy plots
library('ggdag')   # for directed acyclical graphs
library('cowplot') # for plots in grids

plot_grid(
  dagify(Y ~ TOD + DOY + Temp,
         Temp ~ TOD + DOY,
         TOD ~ DOY,
         outcome = 'Y',
         coords = list(x = c(Y = 0, TOD = -1, DOY = 1, Temp = 0),
                       y = c(Y = 1.2, TOD = 2, DOY = 2, Temp = 0))) %>%
    tidy_dagitty() %>%
    mutate(col = case_when(name == 'Y' ~ '1',
                           name == 'TOD' ~ '0',
                           name == 'DOY' ~ '0',
                           name == 'Temp' ~ '2')) %>%
    ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
    geom_dag_point(aes(color = col), size = 20, alpha = 0.5) +
    geom_dag_point(color = 'black', size = 20, shape = 1) +
    geom_dag_edges() +
    geom_dag_text(aes(label = name), color = 'black', size = 4.5) +
    scale_color_manual(values = c('grey', 'darkorange', 'red')) +
    theme_dag() +
    theme(legend.position = 'none'),
  dagify(RSS ~ `F` + E + W,
         `F` ~ Temp,
         E ~ Temp,
         W ~ Temp,
         outcome = 'RSS',
         coords = list(x = c(RSS = 0, `F` = -1, E = 0, W = 1, Temp = 0),
                       y = c(RSS = 2, `F` = 1, E = 1, W = 1, Temp = 0)))%>%
    tidy_dagitty() %>%
    mutate(col = case_when(name == 'RSS' ~ '1',
                           name == 'F' ~ '0',
                           name == 'E' ~ '0',
                           name == 'W' ~ '0',
                           name == 'Temp' ~ '2')) %>%
    ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
    geom_dag_point(aes(color = col), size = 20, alpha = 0.5) +
    geom_dag_point(color = 'black', size = 20, shape = 1) +
    geom_dag_edges() +
    geom_dag_text(aes(label = name), color = 'black', size = 4.5) +
    scale_color_manual(values = c('grey', 'darkorange', 'red')) +
    theme_dag() +
    theme(legend.position = 'none'), labels = 'AUTO', nrow = 1)
```

### Effects of temperature on movement rates

\noindent We estimated the effects of temperature ($^\circ$C) on mammals' instantaneous movement state (moving or not) and speed when moving using two Hierarchical Generalized Additive Models [HGAMs, see @pedersen_hierarchical_2019 and the code chunk below] with the `mgcv` package for `R` [version 1.9-1, @wood_generalized_2017]. The first HGAM estimated the probability that an animal was moving, $P(M)$, with a binomial family of distributions and logit link function. The response variable `moving` was coded as 1 if moving and 0 if not. The second HGAM estimated an animal's speed when moving (`speed`) with a gamma family of distributions and log link function.

The HGAMs included random intercepts for each animal (`s(animal, bs = 're')`), fixed-effect intercepts for each species (`species`), and species-level `by` smooths (`s(..., by = species)`), which allowed each species' term to be estimated independent of other species [see model I in Figure 4 of @pedersen_hierarchical_2019]. The `by` smooths accounted for trends in time of day (in Pacific Daylight Time; `tod_pdt`), day of year (`doy`), and temperature (`temp_c`). The models also had three tensor product interaction terms (`ti()`) `by` each species: (1) day of year and time of day, (2) temperature and time of day, and (3) temperature and day of year. These three terms accounted for: (1) seasonal changes in day length, (2) hourly changes in the response to temperature (e.g., changes in nocturnality), and (3) seasonal changes in the response to temperature (e.g., changes in coats and migration timing). Finally, smooth terms of log-transformed hours between GPS locations (`dt`) accounted for irregular sampling rates. A global term of `log(dt)` accounted for the overall effect of sampling interval, while a factor-smooth interaction term (`s(log(dt), species, bs = 'fs')`) allowed for species-level deviations from the global term while assuming a common smoothness parameter across species [see model GS in Figure 4 of @pedersen_hierarchical_2019].

The HGAMs accounted for the cyclicity of time of day and day of year using cyclic cubic splines [`bs = 'cc'`, see p. 202 of @wood_generalized_2017]. We fit the models with fast Restricted Maximum Likelihood (`'fREML'`) and discretized covariates (`discrete = TRUE`) to optimize computational efficiency with no appreciable losses to model performance [Appendix B$;$ @wood_generalized_2015; @wood_generalized_2017-1; @li_faster_2020]. Together, the binomial HGAM and the gamma HGAM inform us on an animal's long-term average speed, since it is the product of the probability of moving and its average speed when moving.

\clearpage

\singlespacing

\scriptsize

```{r hgams, eval=FALSE, echo=TRUE}
m_moving <- bam(
  moving ~
    s(animal, bs = 're') +
    species + #' necessary since `by` terms do not include intercept terms
    s(tod_pdt, by = species, k = 5, bs = 'cc') +
    s(doy, by = species, k = 5, bs = 'cc') +
    s(temp_c, by = species, k = 5, bs = 'tp') +
    ti(doy, tod_pdt, by = species, k = 5, bs = c('cc', 'cc')) +
    ti(temp_c, tod_pdt, by = species, k = 5, bs = c('tp', 'cc')) +
    ti(temp_c, doy, by = species, k = 5, bs = c('tp', 'cc')) +
    s(log(dt), k = 3) +
    s(log(dt), species, k = 3, bs = 'fs'),
  data = d,
  method = 'fREML', # fast REML
  discrete = TRUE, # discretize the covariates for faster computation
  knots = list(tod_pdt = c(0, 1), doy = c(0.5, 366.5))) #' for `bs = 'cc'`
  
m_speed <- bam(
  speed_est ~
    s(animal, bs = 're') +
    species +
    s(tod_pdt, by = species, k = 5, bs = 'cc') +
    s(doy, by = species, k = 5, bs = 'cc') +
    s(temp_c, by = species, k = 5, bs = 'tp') +
    ti(doy, tod_pdt, by = species, k = 5, bs = c('cc', 'cc')) +
    ti(temp_c, tod_pdt, by = species, k = 5, bs = c('tp', 'cc')) +
    ti(temp_c, doy, by = species, k = 5, bs = c('tp', 'cc')) +
    s(log(dt), k = 3) +
    s(log(dt), species, k = 3, bs = 'fs'),
  family = Gamma(link = 'log'),
  data = d_2, #' data filtered for only moving
  method = 'fREML',
  discrete = TRUE,
  knots = list(tod_pdt = c(0, 1), doy = c(0.5, 366.5)))
```

\normalsize

\doublespacing

<!-- \clearpage -->

### Effects of temperature on habitat selection

\noindent We estimated the effects of temperature on each species' selection for percent forest cover (`forest_perc`), elevation (`elevation_m`), and distance from water (`dist_water_m`) by fitting a Hierarchical Resource Selection Function for each species using an HGAM with a Poisson family of distributions and log link function [Appendix B$;$ @aarts_estimating_2008]. After removing non-resident individuals (Table B1), we accounted for the spatiotemporal autocorrelation in the telemetry locations by weighting each point based on the telemetry's Autocorrelated Kernel Density Estimate [@fleming_new_2017; @noonan_comprehensive_2019] to produce estimates of second- and third-order habitat selection [@johnson_comparison_1980]. While we recognize there are other important drivers of habitat selection (e.g., forest age, forest type, terrain ruggedness, prey availability), we decided to only use these three proxies to produce results that are easily comparable across species. Each species' model had the same structure:

\singlespacing

\scriptsize

```{r rsf, eval=FALSE, echo=TRUE}
rsf <- bam(
  detected ~ # 1 for telemetry locations, 0 for quadrature points
    # species-level average resource preference
    s(forest_perc, k = 6, bs = 'tp') +
    s(elevation_m, k = elev_k, bs = 'tp') +
    s(dist_water_m, k = 6, bs = 'tp') +
    # animal-level deviations from the species-level average
    s(animal, bs = 're') +
    s(forest_perc, animal, k = 6, bs = 'fs', xt = list(bc = 'cr')) +
    s(elevation_m, animal, k = 6, bs = 'fs', xt = list(bc = 'cr')) +
    s(dist_water_m, animal, k = 6, bs = 'fs', xt = list(bc = 'cr')) +
    # changes in preference with temperature
    ti(forest_perc, temp_c, k = 6, bs = 'tp') +
    ti(elevation_m, temp_c, k = 6, bs = 'tp') +
    ti(dist_water_m, temp_c, k = 6, bs = 'tp') +
    # include marginals of temperature to remove sampling biases
    s(temp_c, k = 4, bs = 'tp') +
    s(temp_c, animal, k = 4, bs = 'fs', xt = list(bc = 'cr')),
  family = poisson(link = 'log'),
  data = d, # species-specific dataset
  weights = weight, # based on AKDE
  method = 'fREML',
  discrete = TRUE)
```

\normalsize

\doublespacing

Smooth effects of percent forest cover, elevation, and distance to water accounted for the species-level average selection strength for each resource. A random effect for each individual animal (`s(animal, bs = 're')`) corrected for uneven sampling across individuals, while factor smooth interaction terms (`bs = 'fs'`) accounted for individual-level resource selection [i.e., individual-level deviations from the species-level average$;$ @jeltsch_need_2025]. Tensor interaction product terms (`ti()`) of the three resources and temperature estimated the change in resource selection at different temperatures. Finally, we included marginal smooth terms of temperature to account for species- and individual-level sampling biases over temperature (e.g., sampling more during warm periods). Detections were weighted proportionally to their degree of independence from other temporally proximate detections [`weights = weight` -- Appendix B$;$ @alston_mitigating_2022], while quadrature points had a weight of 1. Quadrature points were obtained using all raster cells in the 99.9% AKDE percentile. The number of quadrature locations greatly outnumbered the number of observed locations (Fig. B12), especially after accounting for weighting based on the degree of autocorrelation and the number of home range crossings (Fig. B13).

```{r, eval=FALSE}
library('mgcv')
library('purrr')
x <- list.files('H:/GitHub/bc-mammals-temperature/models/', 'rsf-', include.dirs = FALSE, full.names = T)
x <- x[grepl('2024-10', x)]
map_int(x, \(f) readRDS(f)$iter)
```

# Results

\noindent Overall, 2.6% of GPS locations had temperatures lower than $-20^\circ$C, while 6.5% had temperatures above $20^\circ$C, and temperature ranges differed across species (Table \@ref(tab:temp-qs), Fig. B2). At $0^\circ$C, species differed in overall mean probabilities of movement (range: 0.05 -- 0.31), mean speed when moving (range: 0.42 -- 2.67 km/h), and mean distance traveled (i.e., $P(M) \times \mathbb E(S)$, range: 0.04 -- 0.61 km/h; Table \@ref(tab:gam-intercepts)). Grizzly bears tended to move least often ($P(M) \approx 0.05$), while wolves and cougars moved most often ($P(M) \ge 0.22$). When moving, mountain goats and southern mountain caribou moved the slowest ($\mathbb E(S|M) \approx 0.43$ km/h), while wolves had the highest mean speed when moving ($\mathbb E(S|M) \approx 2.64$ km/h). Consequently, wolves traveled, on average, 0.6 km/h -- 2.5 to 16.7 times further than other mammals at $0^\circ$C.

```{r temp-qs}
library('dplyr')
d <- readRDS('../data/hgam-speed-data.rds')
get_perc <- function(bools) {
  out <- as.character(round(mean(bools) * 100, 1))
  if(grepl('\\.', out)) {
    out <- paste0(out, ' %')
  } else {
    out <- paste0(out, '.0 %')
  }
  return(out)
}

bind_rows(
  d %>%
    rename(Species = species) %>%
    group_by(Species) %>%
    summarize(`T < -20\\textdegree{} C` = get_perc(temp_c < -20),
              `T > +20\\textdegree{} C` = get_perc(temp_c > +20)),
  d %>%
    summarize(Species = 'Total',
              `T < -20\\textdegree{} C` = get_perc(temp_c < -20),
              `T > +20\\textdegree{} C` = get_perc(temp_c > +20))) %>%
  knitr::kable(format = 'markdown', caption = paste0("Percentage of observed GPS locations (after data cleaning) with temperatures below -20\U00B0", "C or above 20\U00B0", "C."))
```

\scriptsize

```{r gam-intercepts}
setwd('~/GitHub/bc-mammals-temperature')
library('mgcv')
library('dplyr')
library('ctmm') #' for `%#%`
source('analysis/figures/default-ggplot-theme.R')

get_int <- function(.m) {
  newd <- mutate(.m$model[1:7, - 1], species = SPECIES, temp_c = 0, dt = 1)
  predict(.m, type = 'response', newdata = newd,
          terms = c('(Intercept)', 'species',
                    's(temp_c)', paste0('s(temp_c):species', SPECIES),
                    's(log(dt))', 's(log(dt),species)'))
}

intercepts <- tibble(
  Species = SPECIES,
  'P(M)' = get_int(readRDS('models/binomial-gam-without-temperature.rds')),
  'P(M|T)' = get_int(readRDS('models/binomial-gam.rds')),
  'E(S)' = 'km/h' %#% get_int(readRDS('models/gamma-gam-without-temperature.rds')),
  'E(S|T)' = 'km/h' %#% get_int(readRDS('models/gamma-gam.rds')),
  'E(D)' = `P(M)` * (`E(S)`),
  'E(D|T)' = `P(M|T)` * (`E(S|T)`)) %>%
  mutate(Species = case_when(
    Species == 'Rangifer tarandus (s. mountain)' ~ 'R. tarandus (sm)',
    Species == 'Ursus arctos horribilis' ~ 'U. arctos horr.',
    Species == 'Puma concolor' ~ 'Puma concolor',
    Species == 'Cervus canadensis' ~ 'C. canadensis',
    Species == 'Rangifer tarandus (boreal)' ~ 'R. tarandus (b)',
    Species == 'Canis lupus' ~ 'Canis lupus',
    Species == 'Oreamnos americanus' ~ 'O. americanus')) %>%
  mutate(Species = paste0('\\emph{', Species, '}') %>%
           gsub(')}', ')', .) %>%
           gsub(' \\(', '} \\(', .))

if(FALSE) {
  hist(intercepts$`P(M)`)
  hist(intercepts$`E(S)`)
  round(range(max(intercepts$`E(D)`) / intercepts$`E(D)`[- which.max(intercepts$`E(D)`)]), 1)
  
  intercepts %>%
    transmute(Species,
              p = round(`P(M|T)` - `P(M)`, 2),
              s = round(`E(S|T)` - `E(S)`, 2),
              d = round(`E(D|T)` - `E(D)`, 2))
  
  intercepts %>%
    arrange(desc(`E(D)`)) %>%
    mutate(displ_wolf = `E(D)`[grepl('Canis lupus', Species)] / `E(D)`,
           displ_wolf_t = `E(D|T)`[grepl('Canis lupus', Species)] / `E(D|T)`)
}

intercepts %>%
  arrange(Species) %>%
  rename_with(\(.x) paste0('$', .x, '$'), ! Species) %>%
  rename_with(\(.x) gsub('\\|', '\\\\vert ', .x)) %>%
  rename_with(\(.x) gsub('P', '\\\\hat{P}', .x)) %>%
  rename_with(\(.x) gsub('E', '\\\\hat{\\\\mathbb E}', .x)) %>%
  knitr::kable(format = 'markdown', digits = 2, caption = paste0("Mean probability of movement (P(M)), speed ($\\mathbb E(S)$, km/h, assuming constant movement), and distance travelled ($P(M) \\times \\mathbb E(S) = \\mathbb E(D)$, km/h) as estimated by models without and with temperature ($\\mathbb E(... | T)$), after post-stratifting to a 1-hour sampling rate and a temperature of T = 0\U00B0", "C."))
```

\normalsize

Near 0$^\circ$C, wolves selected for dense forest cover ($\gtrapprox$ 50%), elevations near 1 km, and distances from water < 10 km; elk selected for forest cover near 50%, elevations between 1 and 2 km, and distances from water of 5-15 km; mountain goats selected for sparse (< 50%) forest cover, elevations between 1 and 2 km; cougars selected for dense forest cover, an elevation of ~ 1 km, and distances from water < 10 km; boreal caribou selected for intermediate to dense forest cover, elevations near 500 m, and distances from water < 10 km; southern mountain caribou selected for dense forest cover, elevations near 2 km, and distances from water < 5 km; and grizzly bears selected for sparse forest cover (25-50%), elevation near 1 km, and distances from water < 2 km.

There was relatively strong agreement between models with and without temperature (Figs. B3, and B14), but including temperature always resulted in better fits. All analyses of deviance showed that temperature significantly affected movement behavior (all p-values $< 2.2\times10^{-16}$; all $\Delta$AIC $\ge$ 342; Table B2 and following pages in Appendix B). Accounting for temperature resulted in a simpler HRSF for mountain goats (lower model degrees of freedom) that fit the data better (lower deviance), and hence no test was necessary to show that the inclusion of temperature produced a better fit.

## Effects of temperature on movement rates

```{r, eval=FALSE}
library(mgcv)
# to  get deviance explained
summary(readRDS('models/binomial-gam.rds'), re.test = FALSE)$dev.expl
summary(readRDS('models/gamma-gam.rds'), re.test = FALSE)$dev.expl
```

\noindent The effects of temperature on movement rates varied in both direction and magnitude across species, even after accounting for differences in daily and seasonal activity (e.g., sleeping, migration, hibernation; Figs. B4-B6). Smooth interaction terms were well-behaved and indicated clear shifts in activity over time of day and day of year for all species. The models had good in-sample prediction (Fig. B7) and explained reasonably high proportions of the deviance (79.3% for the Gamma model and 10.7% for the binomial model, which is relatively high for a binomial model with binary responses: see ch. 11 of @mcelreath_statistical_2020]. All species adapted their daily and seasonal movement behaviour to changes in temperature (Fig. \@ref(fig:dist)). The clearest example of this was cougars. In mid summer, they moved mostly in the evening if temperatures were cool and mostly in the early morning if temperatures were hot. Throughout the year, they tended to move more when it was colder, but what they perceived as "colder" depended on the time of year. However, uncertainties around the estimated effects were often higher at extreme temperatures due to data scarcity. All species' estimated probability of moving decreased with sampling intervals approximately above 1 hour, and most species' estimated speed when moving decreased monotonically with sampling interval, although the estimated trends were highly uncertain for some species (Fig. B8).

```{r dist, fig.cap="\\textbf{Temperature is a strong determinant of how far and when mammals travel.} The fill indicates the estimated effects of temperature on the relative change in distance travelled (probability of moving times mean speed when moving) over time of day on June $1^{\\text{st}}$ (\\textbf{A}) and day of year at 12:00 PDT (\\textbf{B}). Predictions in the surface plots extend to 10% of the range away from each datum. The color bar is on the $\\log_2$ scale to help visualize patterns in doubling, and values are capped to $2^{\\pm 2}$ for ease of readability."}
# not specifying dt, or doy for A and time for B because change is relative
knitr::include_graphics('../figures/distance.png')
```

## Effects of temperature on habitat selection

Species' relative selection strength (RSS) was generally strongest for elevation and weakest for forest cover, but species' RSS for resources depended on temperature (Fig. \@ref(fig:hrsfs)). Changes in RSS with temperature were also strongest for elevation and generally weakest distance from water, but there were no common trends across all species for any of the three resources. All species, with the exception of cougars, exhibited a clear temperature-dependent shift in their preference for forest cover. At higher temperatures, wolves, mountain goats, and grizzly bears became less selective for forest cover, while elk and caribou shifted towards more intermediate forest cover without much of a change in preference width. All species shifted elevationally with temperature, although boreal caribou's selection strength for elevation was less sensitive to elevation. Overall, as temperatures rose, elk, mountain goats, and cougars increased in elevation, while boreal wolves, southern mountain caribou, and grizzly bears decreased in elevation. Most species generally remained within 5 km of water, and temperature did not affect their selection strength as much as for the other two resources. Again, estimated RSS values were generally most uncertain at extreme temperatures (Fig. B15).

```{r hrsfs, fig.cap="\\textbf{Temeperature strongly affects mammals' habitat selection.} Estimated relative selection strength (RSS) for forest cover (\\%), elevation (km), and distance from water (km) as a function of temperature. The grey contours indicate the extent of each species' observed data. RSS values were re-centered and capped to $2^{\\pm 2}$ to improve readability."}
knitr::include_graphics('../figures/hrsf-surface-plots.png')
```

## Predicted changes in movement during the 21^st^ century

\noindent The predicted changes in distance traveled varied across species in both direction and magnitude, but worse climate-change SSPs always corresponded to greater absolute changes (Fig. \@ref(fig:t-dist)). Additionally, species that were predicted to move less often did not necessarily have lower speeds when moving, and vice versa (Figs. B9 and B10). Overall, absolute changes by 2100 under the best-case SSP were small (approximately 0% to +4%), while under the worst-case SSP absolute changes ranged from ~2% (grizzly bears) to ~24% (cougars). Notably, while the models estimated that grizzly bears would move substantially less (if at all) in winter (Figs. \@ref(fig:dist), B4-B6), the models did not explicitly account for changes in hibernation phenology. Consequently, the climate change projections do not explicitly account for changes in energetic needs or physiology. Projected changes also varied spatially due to heterogeneity in projected climate change (Fig. \@ref(fig:s-dist)). Again, absolute changes were generally greatest under worse SSPs, but the direction of change at each location also varied across SSPs (most visible in cougars).

```{r, eval=FALSE, echo=FALSE}
library('dplyr')

readRDS('../data/cc-hgam-projections.rds') %>%
  group_by(species) %>%
  filter(grepl('Best', scenario), year > 2095) %>%
  summarise(mean = mean(d_median)) %>%
  mutate(mean = abs(mean - 1) * 100) %>%
  arrange(mean)

readRDS('../data/cc-hgam-projections.rds') %>%
  group_by(species) %>%
  filter(grepl('Worst', scenario), year > 2095) %>%
  summarise(mean = mean(d_median)) %>%
  mutate(mean = abs(mean - 1) * 100) %>%
  arrange(mean)
```

```{r t-dist, fig.cap="\\textbf{The direction and magnitude of changes in movement rates due to climate change varies among species, but worse climate-change scenarios result in the greatest change.} Lines indicate the median projected change in distance travelled (probability of moving times speed when moving) due to changes in temperature within each species' observed extent. Shaded areas indicate the range of predicted values between the $95^\\text{th}$ and $5^\\text{th}$ percentiles. Changes are relative to the predicted mean distances travelled in 2025 across the four Shared Socioeconomic Pathways (SSPs). If the intervals are fully above the dashed line, at least 90% of the estimated means increased, relative to the each pixel's average of the four climate SSPs in 2025. Similar conclusions can be drawn regarding a decrease if the ribbons are below the dashed line. The projections only account for changes in movement behaviour (i.e., movement frequency and speed) and ignore changes in physiology or movement costs."}
knitr::include_graphics('../figures/distance-travelled-local-cc-predictions.png')
```

```{r s-dist, fig.cap="\\textbf{Climate change will impact each species' movement rates differently.} The color scale indicates the predicted changes in distance traveled in 2100, relative to each pixel's average distance in 2025 across all four scenarios (i.e., not relative to other pixels). Values < 1 indicate a decrease, and values > 1 indicate an increase. For ease of readability, the color bar is on the $\\log_2$ scale to help visualize patterns in doubling, and values are capped to 0.67 and 1.5 ($\\approx 2^{\\pm 0.585}$; original data ranged 0.50 to 1.56). The predictions only account for the predicted temperature throughout the province and ignore environmental factors such as terrain slope, soil type, and forest density. All maps are shown with a BC Albers projection (EPSG:3005)."}
if(FALSE) range(readRDS('../data/cc-hgam-projections-local-2100.rds')$d)
knitr::include_graphics('../figures/local-distance-2100.png')
```

Median RSS was projected to decrease over time within the each species' observed range, but changes were stronger under worse SSPs (Fig. \@ref(fig:s-hrsfs)). Decreases were most pronounced in the bottom fifth percentile and most severe for elk, southern mountain caribou, and mountain goats. Of all the species, only cougars showed a clear increase in RSS for areas within their current range. The change in RSS between 2025 and 2100 varied spatially for all species (Fig. \@ref(fig:s-hrsfs)). All species were predicted to exhibit a decrease in RSS throughout most of their observed habitats, although cougars were predicted to increase their selection for patches with higher altitude.

```{r, eval=FALSE}
library('dplyr')

readRDS('../data/cc-hrsf-projections.rds') %>%
  group_by(lab) %>%
  filter(grepl('Best', scenario), year > 2095) %>%
  summarise(mean = mean(l_median)) %>%
  mutate(mean = (mean - 1) * 100,
         decreased = mean < 0) %>%
  arrange(mean)

readRDS('../data/cc-hrsf-projections.rds') %>%
  group_by(lab) %>%
  filter(grepl('Worst', scenario), year > 2095) %>%
    summarise(mean = mean(l_median)) %>%
  mutate(mean = (mean - 1) * 100,
         decreased = mean < 0) %>%
  arrange(mean)
```

```{r t-hrsfs, fig.cap="\\textbf{All species are expected to exhibit a decrease in median relative selection strength (RSS) for their current range, irrespective of climate change scenario, but decreases are stronger in the worse-case scenario.} Lines indicate the projected change in median RSS within each species' observed extent within BC, while the ribbons indicate the range between the $95^\\text{th}$ and $5^\\text{th}$ percentiles in RSS. Changes are relative to each location's mean RSS in 2025 across the four Shared Socioeconomic Pathways (SSPs)."}
knitr::include_graphics('../figures/rss-local-cc-predictions.png')
```

```{r s-hrsfs, fig.cap="\\textbf{Climate change will impact each species' habitat relative selection strength (RSS) differently.} The color scale indicates the predicted changes in RSS in 2100, relative to each location's average RSS in 2025 across all four scenarios (i.e., not relative to other pixels). Values < 1 indicate a decrease and values > 1 indicate an increase. For ease of readability, the color bar is on the $\\log_2$ scale to help visualize patterns in doubling, and values are capped to 0.67 and 1.5 ($\\approx 2^{\\pm 0.585}$; original data ranged 0.66 to 1.86). All maps are shown with a BC Albers projection (EPSG:3005)."}
if(FALSE) range(readRDS('../data/cc-hrsf-projections-local-2100.rds')$l)
knitr::include_graphics('../figures/local-rss-2100.png')
```

# Discussion

<!-- - address any questions presented in the introduction -->

\noindent We have demonstrated that temperature is an important determinant of whether, how, and where large mammals move, even while accounting for seasonality (e.g, changes in photoperiod, hormones, and resources). Disentangling temperature from other drivers is important for predicting how changes in climate will affect mammalian movement when other drivers remain approximately constant. However, predicting mammals' responses to climate change becomes increasingly complex as habitats warm and animals are exposed to increasingly frequent conditions that are both extreme and novel.

Predicting mammals' responses at the data-scarce fringes of the surface plots in Figs. \@ref(fig:dist) and \@ref(fig:hrsfs) comes with substantial uncertainty, particularly given that the responses are nonlinear. At warm temperatures, mammals (and other homeotherms) overheat [@alston_temperature_2020; @dyer_travel_2023], so their movement behaviour and that of their competitors, predators, and/or prey can often be substantially different from the behaviour at typical temperatures. As extreme temperature events become more frequent and prolonged throughout the year [@yao_emergence_2022; @ipcc_climate_2023], mammals will be increasingly forced towards atypical behaviours that may alter community structures and behaviours, both during such events and afterwards [@zhang_increased_2023; @logares_black_2012; @anderson_black-swan_2017]. For instance, changes in climate and phenology impact the life history and behaviour of many hibernating mammals [@wells_life_2022], and hot weather can also affects mammals' sleep quality [@mortlock_sleep_2024] and likelihood to enter torpor [@fjelldal_nightly_2021].

Changes in animal movement behavior may also alter the frequency and intensity of human-wildlife conflict, especially with the addition of growing pressures from human development and presence [@sih_evolution_2011; @johnson_human_2018; @weststrate_how_2024]. At the same time, warmer winters may reduce mammals' energetic expenditure [@berger_climate_2018; @schmidt_interplay_2020], increase ease of movement as snow cover and depth decrease [@leclerc_determinants_2021; @melin_effect_2023], increase their chances of finding food or being preyed on [@hou_cold_2020; @gilbert_behavioral_2017; @pedersen_quantifying_2021; @slatyer_ecological_2022; @sullender_defining_2023], and affect the timing and duration of migrations [@sawyer_identifying_2009; @leclerc_determinants_2021; @xu_plasticity_2021]. These changes will likely have complex consequences for population and ecosystem structures and dynamics as prey, predators, and competitors experience altered seasonal cycles and increasingly common climate "weirding" [@bunnell_global_2011].

Our ability to respond changes in climate is contingent on our ability to prepare for and predict change. However, predicting animal behaviour becomes increasingly complicated as the conditions animals are exposed to deviate from current, typical conditions, especially when responses are nonlinear and data are sparse. Consequently, we do not present our results as a definitive guide to how mammals in western Canada will respond to climate change. Instead, we hope they serve as a starting point to (1) demonstrate that mammals' movement rates and habitat selection depend on temperature and (2) how one can estimate mammals' changes in movement behaviour due to climate change. Additionally, communicating uncertainty in one's estimates is crucial in assessing risk probabilistically, and appropriate measures of uncertainty require careful and robust modeling [@aven_implementing_2002; @ayre_bayesian_2012; @kluppelberg_bayesian_2014].

*Achieving the "30 by 30" goal will require international collaboration [@huang_achieving_2021] as well as active partnership with local Peoples, especially Indigenous Peoples [@wong_towards_2020; @lamb_braiding_2023]. Understanding the consequences of climate change on mammals' movement behaviour is a first step towards proactively responding to how mammals will respond to human-induced rapid environmental change [@sih_evolution_2011; @williams_range_2018]. In the following sections, we discuss the implications of our results in more detail. We then expand on consequences for conservation during the 21^st^ century and considerations for future studies.*

## Effects of temperature on movement rates

\noindent The heterogeneity mammals' responses to temperature suggests that ecological communities will respond to change in complex and interconnected ways. Although our models do not account for explicit physiological or phenological changes, the surfaces in Fig. \@ref(fig:dist) suggest that warmer temperatures cause many species to alter their daily and seasonal activity patterns (most visible in cougars and grizzly bears). For example, when temperatures were above 0$^\circ$C, cougars moved most at night, but when temperatures were below 0$^\circ$C they tended to move more throughout the day. Throughout the year, they adapted their tolerance to temperature and moved less when it was relatively hot (for a given time of year), especially in spring and summer. The strong reduction in the mid-day movement rates of wolves, elk, cougars, and boreal caribou when summer temperatures were above 20$^\circ$C suggests that the increasingly common and intense heat waves across western Canada will have community-wide impacts on movement rates, encounter rates, and potentially community structure [@martinez-garcia_how_2020]. More work is necessary on quantifying interspecific responses to temperature, including the effects of temperature on predation rates [but see: @cunningham_opportunity_2021; @glass_trade-off_2021; @brivio_seeking_2024]. The increase in intensity and frequency of extreme heat events [@bunnell_global_2011; @yao_emergence_2022] will likely also impact the occurrence and timing of hibernation [@wells_life_2022] and migration or seasonal range expansions [@carbeck_adaptation_2022; @morley_spatiotemporal_2021; @malpeli_ungulate_2022]. However, not all species may be able to adapt at the current rate of climate change [@williams_range_2018; @hetem_responses_2014], especially since landscape changes will likely depend not only on the direct effect of temperature but also on cascading changes in the availability and unpredictability of resources [@mclellan_effect_2015; @pigeon_drivers_2016; @mezzini_how_2025].

## Effects of temperature on habitat selection

As with the effects of temperature on movement rates, the hererogeneity of temperature effects on species' habitat selection indicates that efficient and proactive habitat conservation will require taxonomic nuance. In particular, our HRSFs did not account for any explicit physiological responses to temperature that may impact movement, such as changes in the phenology of plants, fire, ice, or mammalian physiology (e.g., moulting, fat storages) or behaviour (e.g., migration, food caching), other than as direct responses to temperature. Consequently, the behavioural changes we present should be interpreted carefully. While some seasonal cycles do not depend directly on temperature and may thus not be impacted directly by climate change [such as those driven by photoperiod, see @liu_effects_2022], the predictions we present also rely on the assumption that mammals will not adapt these seasonal cycles to temperature-dependent cues, such as weather [@xu_frost_2019] or forage availability [@middleton_green-wave_2018], which may not be correct. Additionally, it is important to stress the distinction between habitat selection and quality. While animals tend to select for high-quality habitats [@kacelnik_ideal_1992; @wright_survival_2024], high selection strength can also be a consequence of an ecological trap [@zuniga-palacios_what_2021; @swearer_overview_2021].

## Predicted changes in movement during the 21^st^ century

Achieving the goals laid out by the "30 by 30" conservation initiative [@convention_on_biological_diversity_154_2022] will require careful planning but often also rapid action. In the case of Canada, only 13.7% of its terrestrial areas and inland waters were protected at the end of 2023 [@environment_and_climate_change_canada_canadian_2024; @minister_of_environment_and_climate_change_act_2024]. Additionally, efficient and effective conservation will require collaboration with Indigenous and local communities to ensure Treaties are respected in the process [@falardeau_biophysical_2022; @lamb_braiding_2023; @wong_towards_2020; @turner_its_2009] while also actively preparing for future change [@desjardins_looking_2020; @hessami_indigenizing_2021].

The diversity in predicted changes in movement behavior by 2100 (both across species and within species' current ranges) and high spatial heterogeneity in Fig. \@ref(fig:s-hrsfs) highlight the need for careful planning that incorporates not only reliable estimates of change but also pragmatic and communicable measures of uncertainty and variability around such estimates. For example, the width of the prediction intervals in Fig. \@ref(fig:t-dist) suggest that spatial and intra-individual variation should be accounted for when deciding the location and size of protected areas [@jeltsch_need_2025]. Population-level means that ignore such variation can greatly limit the efficacy of conservation projects [@muff_accounting_2020; @mortlock_sleep_2024; @silva_too_2025]. Additionally, accurate estimates of the effects of changes in temperature on mammals' movement require a holistic view of the direct effects of temperature on mammals' movement directly as well as its effects on other drivers of movement, such as forage and prey availability [@mezzini_how_2025], encounter rates [@hou_cold_2020; @martinez-garcia_how_2020], population dynamics [@smith_densitydependent_2023], competitive pressure [@torrez-herrera_monkeys_2020], and predation risk [@kohl_prey_2019]. This complexity results in the great variation among the responses of different species (and individuals), especially as populations undergo a rapid cascade of change [@botero_evolutionary_2015] and animals face increasing pressures from human activity, including habitat fragmentation, habitat loss, and greater human presence in wild spaces [@sih_evolution_2011; @tucker_moving_2018; @sawyer_identifying_2009; @weststrate_how_2024; @rosenthal_impact_2022; @rice_conspicuous_2022]. As selection strength for current ranges changes (and likely decreases), some animals may disperse, relocate to a new habitat, or remain within the current range despite the reduced fitness and increased extinction risk [@logares_black_2012; @anderson_black-swan_2017; @duncan_predicting_2012].

## Species-specific considerations

### *Canis lupus*



### *Cervus canadensis*



### *Oreamnos americanus*



### *Puma concolor*

attraction for disconnected patches of high elevation could lead to fragmentation or traps

### *Rangifer tarandus* (boreal)

Increasing temperatures increased RSS for both elevations near ~500 m as well as > 1,000 m, but such a selection is only possible if: (1) such habitats exist in the animals' range, and (2) crossing the 500 m to > 1,000 m regions is safe and attractive

### *Rangifer tarandus* (s. mountain)

HRSFs do not account for migratory behavior due to reproduction or predation risk

### *Ursus arctos horribilis*



## Considerations for future studies

Our work highlights three central considerations for future research: (1) telemetry sampling rates should be designed primarily in relation to the movement timescales of the species of interest [@noonan_scale-insensitive_2019; @nathan_big-data_2022; @pease_ecological_2024], (2) the number of individuals tracked and the length of each telemetry should depend not just on population size but also the rate of environmental change, and (3) predicting changes in movement behaviour becomes highly complex when responses are nonlinear, especially when changes depend on many interacting factors [@polazzo_measuring_2024] and one is interested in predicting responses in extreme conditions for which data are scarce [@steixner-kumar_strategies_2020].

While the `ctmm` movement models produced scale-independent estimates of speed [i.e., model interpretation is independent of sampling interval: @noonan_scale-insensitive_2019], the accuracy, size, and stability of speed estimates still depended on the GPS sampling frequency. This dependency is because coarsely-sampled movement data contains information on large-scale movements (range crossings, migrations) but not fine-scale movements, including first-order habitat selection [@johnson_comparison_1980]. Using the boreal caribou as an example, the 13-hour sampling interval allows us to reasonably estimate the caribou's movement path at a temporal scale of approximately 13 hours (or greater), but we cannot produce reasonable movement trajectories at a much finer (e.g., hourly) scale. @nathan_big-data_2022 provides additional examples of how the frequency of location data affects the results that can be inferred by modeling movemet behavior. Consequently, we suggest being cautious when comparing estimated movement behaviours across species, even though all predictions have been corrected to the hourly timescale by predicting for 1-hour time intervals (i.e., `dt_hours = 1`). Ideally, sampling schedules should be fine enough to reconstruct animals' movement movement paths. Good estimates of an animal's speed and trajectory require telemetry locations to be taken more often than the animal's directional persistence [@noonan_scale-insensitive_2019], so that, on average, the dataset contains multiple locations in between changes in direction. What constitutes a change in direction depends on what movement scale one is investigating. Small-scale movements and first-order spatial selection will require more frequent sampling than migratory movement or second-order and third-order spatial selection. While `ctmm` movement models are scale-invariant in that any model can be scaled to larger or smaller areas and timescales, the model estimates are not independent of the scale of the sampling frequency.

When landscapes are relatively predictable across years, a larger number of sampled individuals is likely preferable over the duration of each tracking period. The greater number of tracked animals allows one to quantify the variance across individuals, including the range of conditions and environments that individual animals are in. A good estimate of inter-individual variance provides better coefficient estimates along with more appropriate measures of uncertainty. However, when conditions across years are stochastic, multi-year telemetries allow one to better estimate inter-annual variation without conflating it with inter-individual differences. Given the widespread, rapid, and accelerating changes across many habitats (particulartly at high elevations and at high latitudes), we suggest researchers focus on long-term telemetry datasets to quantify the effects of intra-annal variability while increasing the ranges of temperatures each individual is observed in. Longer observational periods can also improve the chances of observing different community dynamics, such as shifts in predator-prey dinamics.

Temperature affects many aspects of mammalian physiology and behavior, including energetics, sleep, and movement behavior. Climatic changes during the last two centuries have exposed many mammals to novel and increasingly extreme environmental conditions that have led to visible changes that impact not only individuals but also ecological and human communities. However, quantifying the effects of climate change is often complex, especially as conditions become increasingly different and extreme events become increasingly common. Accurately quantifying the nonlinear effects of temperature on when, how, and where mammals move requires careful data collection and model design. We have presented a multi-species analysis of the effects of temperature on mammalian movement rates and habitat selection in hopes that other researchers can leverage this framework and models to expand our understanding of how temperature affects the movement behavior of other species, including smaller mammals, more elusive species, and non-mammal animals. Understanding of how temperature affects each species in a community will allow us to begin making community-level inferences of how temperature will affect intra-specific interactions from a movement behavior perspective [@nathan_movement_2008; @martinez-garcia_how_2020; @nathan_big-data_2022]. While adopting such a perspective is surely not simple, it would result in more complete estimates of the effects of climate change on community ecology, particularly when species are exposed to rapid change in many important variables. Future work should explore the effects of temperature on movement behavior while accounting for finer-scale and species specific variables that were not accounted for in this study. Examples of these include temporally dynamic measures of forest type and age, canopy density, competitive pressures, forage availability, and predator avoidance, or environmental stochasticity. However, many of these data not available, so we also suggest that more work be done on quantifying such measures using spatiotemporally dynamic models and sufficiently fine resolutions. 

# Author contributions

SM performed the data cleaning, ran the analyses, and wrote the majority of the manuscript. CHF wrote code for estimating instantaneous movement speeds. MJN conceived of the project idea and supervised SM throughout the project. All other authors contributed telemetry data and contributed to the interpretation of the results for their species of interest. All authors contributed to reviewing the manuscript.

\clearpage <!-- to prevent figures from floating to the references -->

\newpage <!-- place references on a separate page -->

# References {-}

\hangparas{1em}{1} <!-- paragraphs hanging by width equal to font height -->
