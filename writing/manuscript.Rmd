---
title: "\\Large Rising temperatures alter how and where mammals move"
author:
  - name: Stefano Mezzini
    email: stefano.mezzini@ubc.ca
    institute: [braes, biol]
  - name: Chris H. Fleming
    institute: [ucf, smith]
  - name: Karen E. Hodges
    institute: [braes, biol]
  - name: Siobhan Darlington
    institute: [braes, biol]
  - name: Adam T. Ford
    institute: [braes, biol]
  - name: TJ Gooliaff
    institute: [forest]
  - name: Kirk Safford
    institute: bcp
  - name: Robert Serrouya
    institute: [braes, biol, biodiv]
  - name: Michael J. Noonan
    email: michael.noonan@ubc.ca
    institute: [braes, biol, cmps]
institute:
  - braes: Okanagan Institute for Biodiversity, Resilience, and Ecosystem Services, The University of British Columbia Okanagan, Kelowna, British Columbia, Canada.
  - biol: Department of Biology, The University of British Columbia Okanagan, Kelowna, British Columbia, Canada.
  - ucf: Department of Biology, University of Central Florida, Orlando, Florida 32816, United States.
  - smith: Smithsonian Conservation Biology Institute, National Zoological Park, 1500 Remount Rd., Front Royal, VA 22630, United States.
  - forest: British Columbia Ministry of Forests, Lands, Natural Resource Operations and Rural Development, Penticton, BC, Canada.
  - bcp: British Columbia Ministry of Environment and Parks, Penticton, BC, Canada.
  - biodiv: Wildlife Science Centre, Biodiversity Pathways, University of British Columbia Okanagan, Revelstoke, British Columbia, Canada.
  - cmps: Department of Computer Science, Math, Physics, and Statistics, The University of British Columbia Okanagan, Kelowna, British Columbia, Canada.
bibliography: 'bc-mammals-temperature.bib'
csl: 'global-change-biology.csl'
# csl: 'movement-ecology.csl'
fontsize: 12pt
indent: true
header-includes:
    - \usepackage{setspace}\doublespacing # for double-spaced text
    - \usepackage{indentfirst} # for indenting first line of each paragraph
    - \usepackage[small]{titlesec} # for smaller font for headings
    - \usepackage{caption} # for more customization of captions
    - \captionsetup[figure]{font=footnotesize, aboveskip=4pt, belowskip=-15pt}
    - \usepackage{hanging} # for hanging indents in references
    - \usepackage[left]{lineno} # for line numbers
    - \usepackage{booktabs} # to prevent tables from splitting
subparagraph: true # needed for \usepackage[small]{titlesec}
urlcolor: cyan
output:
  bookdown::pdf_document2:
    latex_engine: xelatex # for Delta symbol in table
    pandoc_args:
      - '--lua-filter=scholarly-metadata.lua'
      - '--lua-filter=author-info-blocks.lua'
    toc: false
    number_sections: true
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
# set chunk defaults: don't print code, images text width and centered
knitr::opts_chunk$set(echo = FALSE, out.width = '\\textwidth',
                      fig.align = 'center', cache = TRUE, warning = FALSE,
                      message = FALSE)
```

\newpage

<!--
available text sizes:
Huge > huge > LARGE > Large > large > normalsize > small > footnotesize > scriptsize > tiny
-->

<!--
six-sentence abstract:

1. introduce the topic
2. state the problem
3. summarize why the question hasn't been answered/what the consequences are
4. explain how you answered the question
5. explain the central findings
6. explain the importance of your findings and their consequences
-->

```{r abstract, echo=FALSE}
abstract <- "Widespread warming during the last century has caused many terrestrial mammals to change how and where they move, with cascading effects on fitness, habitat selection, and community structure. Previous studies have estimated the effects of temperature on mammalian movement behaviour, but few disentangled them from seasonal behaviour cycles. Consequently, it is still uncertain how mammals will adapt their movement behaviour throughout the 21^st^ century. We address this gap by quantifying the effects of temperature on the movement rates and habitat selection of six large-bodied mammalian species throughout western Canada between 1998 and 2023. We show that temperature significantly affects of how and where these mammals move, and we predict that climate change will have significant impacts on mammals' movement behaviour throughout the 21^st^ century. Notably, we found that species did not respond uniformly to temperature. This suggests that community-level responses will be complex, as future climate change drives some species to move more and others less. Median habitat selection strength was predicted to decrease for most species, but some species are expected to show increased selection strength for higher altitudes. Consequently, our results suggest that individuals from all six species may shift their range in the coming decades as they begin to select against portions of their current ranges. The strong but varied responses to temperature suggest that future climate change will impact not only individuals' movement behaviour but also entire communities, as changes in movement behaviour will affect encounter rates, including predator prey-dynamics and human-wildlife interactions. As climate change exposes mammals to novel environmental conditions, proactively anticipating changes in mammalian movement behaviour will become crucial for effectively and proactively understanding community-level responses and selecting high-quality habitat for long-term conservation."
if(FALSE){
  stringi::stri_count_words(abstract)
}
```

\clearpage

\noindent \textbf{Article type}: Research article

\noindent \textbf{Words in abstract}: `r stringi::stri_count_words(abstract)`

\noindent \textbf{Words in main text}: `r suppressMessages(wordcountaddin::word_count())`

\noindent \textbf{Figures}: 8

\noindent \textbf{Tables}: 3

\noindent \textbf{References}: 165 (updated on 2025-09-25) <!-- counted by using movement ecology csl -->

\noindent \textbf{Appendices}: 2

<!-- using "behaviOR" in key words to increase audience -->

\noindent \textbf{Key words:} climate change, temperature, mammals, animal movement, movement behavior, habitat selection

\ 

\clearpage

# Abstract {-}

\noindent `r abstract`

<!-- start main body on a new page -->
\newpage

\doublespacing

\linenumbers

```{r packages, warning=FALSE, message=FALSE}
library('dplyr') # for data wrangling
library('purrr') # for data wrangling
library('tidyr') # for data wrangling
library('ctmm')  # for movement models
```

# Introduction

<!-- movement is a convenient way for ANIMALS to respond to change, but movement depends on temperature -->

\noindent For most animals, movement is a rapid and low-cost response to a variety of stimuli [@nathan_movement_2008]. Animals move to optimize resource use [e.g., food, water, shelter$;$ @charnov_optimal_1976; @kacelnik_ideal_1992; @merkle_large_2016; @mezzini_how_2025], optimize habitat use [@winter_forecasting_2024], and avoid predators and competitors [@peterson_pursuit_2021; @bartashevich_collective_2024; @tan_antipredator_2024; @torrez-herrera_monkeys_2020]. How and where animals move thus determines encounter rates with resources [@mezzini_how_2025], humans [@weststrate_how_2024], predators, prey, and competitors [@martinez-garcia_how_2020; @glass_trade-off_2021; @brivio_seeking_2024]. However, ambient temperature affects animals' movement rates by altering the energetic cost of movement and thermoregulation [@mcnab_body_1970; @taylor_energetics_1982; @brown_toward_2004; @fuller_towards_2016; @jahn_variations_2022], and extreme temperatures can reduce movement rates [@dyer_travel_2023] and even cause physiological damage and death [@hetem_responses_2014; @ratnayake_forecasting_2019; @schmidt_interplay_2020]. Animals may search for a short-term buffer from extreme heat or cold by moving to thermal refugia [@hannah_fine-grain_2014; @elmore_implications_2017; @attias_effects_2018; @arechavala-lopez_common_2019; @gulland_review_2022], and shelter may even be preferred over forage abundance [@hall_microrefuges_2016]. Changes in climate throughout the 21^st^ century and the simultaneous increase in frequency and intensity of extreme-heat events [@ipcc_climate_2023; @bunnell_global_2011] are expected to impact not only animals' movement behavior but also their physiology [@powers_hovering_2017; @schwerdt_ecological_2024], life history [@newediuk_climate_2024], and phenology [@carbeck_adaptation_2022; @johnson_human_2018].

<!-- mammals  -->

Mammals are particularly susceptible to adverse effects from excessive heat [@sherwood_adaptability_2010]. While extreme cold often leads to reduced movement, provided that individuals can find refuge and take advantage of their body heat [@berger_climate_2018; @hou_cold_2020; @glass_trade-off_2021], extreme heat can often result in more severe physiological damage in a shorter span of time [@jessen_temperature_2001; @sherwood_adaptability_2010; @mota-rojas_physiological_2021; @newediuk_climate_2024]. Due to mammals' difficulty at dissipating heat, particularly when ambient temperatures are near or above their body temperature, they are particularly sensitive to extreme heat, especially with increasing body size. Large-bodied mammals are most likely to show changes in movement behaviour with rising temperatures, since they tend to move long distances [@merkle_large_2016], are particularly sensitive to overheating [@fuller_towards_2016; @verzuh_behavioural_2023], and their movement rates are thus strongly limited by excessive heat [@dyer_travel_2023].<!-- Furthermore, species that experience narrow temperature ranges (i.e., $`$temperature specialists') tend to be more sensitive to changes [e.g., giant anteaters, *Myrmecophaga tridactyla*: @giroux_activity_2023], while species that experience wide ranges of temperature variation (i.e., $`$temperature generalists') respond more easily to change [@levins_evolution_1974; @botero_evolutionary_2015; @dupont_beyond_2024]. Still, generalists' greater adaptability is tested when they are subject to changes that are more severe [@mccain_assessing_2019; @rantanen_arctic_2022], affect many factors at once [e.g., temperature, snow depth, ecosystem phenology, and resource availability: @polazzo_measuring_2024], or are too rapid and severe to respond to within a lifetime or a few generations [@levins_evolution_1974; @gienapp_climate_2008; @fuller_towards_2016; @xu_plasticity_2021].-->

<!-- we do not know how temperature will change -->

In the last century, many ecosystems experienced widespread warming that resulted in milder and shorter winters, hotter and longer summers, and a greater risk of extremely high temperatures [@ipcc_climate_2023]. As heat stress intensifies over the next 100 years, mammals will continue to suffer impacts on their fitness, movement rates, and habitat selection [@deb_modelling_2020; @woo-durand_increasing_2020], which will be exacerbated by more frequent and intense extreme events [@bunnell_global_2011] and anthropogenic habitat loss, modification, and fragmentation [@sih_evolution_2011; @sawyer_identifying_2009; @weststrate_how_2024]. It remains unclear how or whether species will be able to respond to climate change in the current century [@deb_modelling_2020; @woo-durand_increasing_2020; @verzuh_behavioural_2023], especially if populations fail to adapt to changes [@sawyer_migratory_2019; @botero_evolutionary_2015] or are physiologically incapable to do so [@sherwood_adaptability_2010; @williams_range_2018]. Preparing for and responding to future changes will require a detailed understanding of how temperature will affect how and where different mammalian species move [@cunningham_opportunity_2021]. Recent work has documented the effects of climate change on mammals' ranges [@leclerc_determinants_2021], thermoregulation [@mota-rojas_physiological_2021], and movement behaviour [@mccain_assessing_2019; @melin_effect_2023; @cunningham_opportunity_2021]. However, there remains a need for fine-scale estimates of the effects of temperature on mammals' movement behaviour and quantitative predictions of changes in movement behaviour with climate change in the current century [@ipcc_climate_2023].

<!-- introduce the study -->

***CLEAN UP PARAGRAPH BELOW***

In this paper, we quantify the effects of proximal air temperature on mammalian movement behaviour, namely movement rates and habitat selection of six large-bodied terrestrial mammal species in western Canada (boreal and southern mountain caribou: *Rangifer tarandus*, cougars: *Puma concolor*, elk: *Cervus canadensis*, grizzly bears: *Ursus arctos horribilis*, mountain goats: *Oreamnos americanus*, and wolves: *Canis lupus*; Table \@ref(tab:data-table)). Western Canada is currently experiencing accelerating and widespread but spatially heterogeneous warming [@dierauer_climate_2021; @kienzle_has_2018; @turner_its_2009], phenological shifts [@tysor_countergradient_2025; @basu_phenological_2024; @kienzle_has_2018], and more frequent and intense extreme heat events [@zhang_increased_2023]. Canadian decision makers must understand which areas will be of greatest value for maximizing and protecting biodiversity not only for current conditions but future decades, too. Failing to understand how climate change will affect mammalian movement behaviour will hinder our ability to respond to the current climate crisis and make decisions that are viable in the long term. Furthermore, understanding how temperature affects individual species is the first step towards understanding how temperature impacts the community dynamics [@hegel_interacting_2010; @carbeck_adaptation_2022; @cunningham_opportunity_2021] and habitat phenology [@bunnell_global_2011; @duncan_predicting_2012; @merkle_large_2016; @slatyer_ecological_2022; @gerlich_species_2025], and how these changes will impact mammals in the coming decades [@sobie_climate_2021; @eum_potential_2023; @weststrate_how_2024]. We discuss the consequences of our findings at the individual, population, and community levels, and we also provide directions for future research and solutions for overcoming some common data limitations.

```{r bc-map, fig.cap="GPS telemetry data for the six species in this study (dots) over a digital elevation model for the study area.", out.width='0.75\\linewidth'}
knitr::include_graphics('../figures/tels-map-dem.png')
```

\scriptsize

```{r, eval=FALSE}
# a quick check for the table below
readRDS('../data/movement-models-speed-weights-2024-06-10.rds') %>%
  group_by(dataset_name, animal) %>%
  summarize(n = n_distinct(animal),
            any_na_speed = any(is.na(speed_est)),
            all_na_speed = all(is.na(speed_est))) %>%
  group_by(dataset_name) %>%
  summarise(n_missing_any = sum(any_na_speed),
            n_missing_all = sum(all_na_speed))
```

```{r data-table}
setwd('..') # go to main directory
source('analysis/figures/default-ggplot-theme.R')

dt_data <-
  readRDS('models/movement-models-2024-06-06.rds') %>%
  transmute(
    Species = case_when(
      dataset_name == 'Canis_lupus_boreal' ~ 'Wolves',
      dataset_name == 'Rangifer_tarandus_boreal' ~ 'Caribou (boreal)',
      dataset_name == 'Rangifer_tarandus_southern_mountain' ~ 'Caribou (southern mountain)',
      dataset_name == 'Puma_concolor_2' ~ 'Cougars',
      dataset_name == 'Puma_concolor_4' ~ 'Cougars',
      dataset_name == 'Elk in southwestern Alberta' ~ 'Elk',
      dataset_name == 'Oreamnos_americanus' ~ 'Mountain goats',
      dataset_name == 'Ursus_arctos_horribilis' ~ 'Grizzly bears'),
    animal, # keep animal column for grouping later
    tel = map(tel, data.frame),
    na_speed = map_lgl(movement_model,
                       \(.m) suppressWarnings(speed(.m)$DOF == 0))) %>%
  unnest(tel) %>%
  group_by(Species, animal) %>%
  summarize(Start = min(as.Date(timestamp, tz = 'America/Vancouver')),
            End = max(as.Date(timestamp, tz = 'America/Vancouver')),
            n = n(),
            dt = median(timestamp - lag(timestamp), na.rm = TRUE),
            animal = unique(animal),
            na_speed = unique(na_speed),
            .groups = 'drop') %>%
  group_by(Species) %>%
  summarize(Start = min(Start),
            End = max(End),
            n = sum(n),
            dt = as.numeric(median(dt, na.rm = TRUE)),
            Animals = n_distinct(animal),
            n_missing = sum(! na_speed),
            .groups = 'drop') %>%
  mutate(dt = round('hours' %#% dt, 2)) %>% # convert from seconds to hours
  rename('\U0394t (hours)' = dt,
         'Has speed' = n_missing)

knitr::kable(dt_data, format = 'markdown', format.args = list(big.mark = ','), caption = "Summary statistics of each species' set of GPS data, namely: the start and end of each set of GPS telemetries, the number of GPS fixes (after data cleaning), the number the median sampling interval ($\\Delta t$; stratified by animal), the number of animals (Animals), and the number of animals with finite speed estimates (Has speed).", escape = FALSE, longtable = FALSE, booktabs = TRUE)
```

\normalsize

# Methods

## Datasets used

In this study, we estimate how temperature affected mammals' probability of moving, speed when moving, and habitat selection by leveraging three datasets: (1) a multi-species collection of 25 years of GPS telemetry data throughout a large spatial range of western Canada (Fig. \@ref(fig:bc-map)), (2) historical, hourly air temperature data from the ERA5 reanalyzed dataset [@hersbach_era5_2023], and (3) temporally static rasters of percent forest cover, elevation, and distance from water. We then forecast each species' movement behaviour thoughout the 21^st^ century using monthly climate change projections under four Shared Socioeconomic Pathways [SSPs$;$ @riahi_shared_2017; @mahony_global_2022]: SSP 1-2.6 ("Sustainability -- Taking the Green Road"; low challenges to mitigation and adaptation), SSP 2-4.5 ("Middle of the Road: medium challenges to mitigation and adaptation), SSP 3-7.0 ("Regional Rivalry -- A Rocky Road"; high challenges to mitigation and adaptation), and SSP 5-8.5 ("Fossil-fueled Development -- Taking the Highway"; high challenges to mitigation, low challenges to adaptation).

We acknowledge that our models of habitat selection ignore many important variables of habitat selection (e.g., forest type, structure, and age; terrain slope and aspect; prey availability; population density). We limited our models to only use three simple and temporally static rasters to produce simple and easily interpretable estimates and forecasts under the assumption of temporally invariant landscapes. See the discussion section for additional detail on the advantages and limitations of using such simple models.

### GPS telemetry data

```{r, eval=FALSE}
tels <- readRDS('data/tracking-data/all-tracking-data-cleaned-2024-02-22-13-49.rds') %>%
  tidyr::unnest(tel)

# all outliers
sum(tels$outlier)
round(mean(tels$outlier) * 100, 2)

# new outliers
sum(tels$outlier & !tels$original_outliers)
round(mean(tels$outlier & !tels$original_outliers) * 100, 2)
```

\noindent Boreal caribou and wolf telemetries were acquired from a data repository of the British Columbia Oil and Gas Research and Innovation Society (BC ORGIS) that was collected as part of the boreal caribou radio-collaring program of the BC OGRIS Research and Effectiveness Monitoring Board [REMB$;$ @bc_ogris_boreal_2018]. Southern mountain caribou data were obtained from the work of @ford_effects_2023. Cougar data include telemetries from @darlington_southern_2025 and @serrouya_ref. Elk data from the work of @ciuti_human_2012 were downloaded from Movebank [@kays_movebank_2022]. ***MISSING INFO ON GRIZZLY BEAR AND GOAT TELEMETRY DATA.***

From the full set of telemetry data, we removed a total of 2396 problematic GPS locations (0.16%, including collar calibration data) after inspecting diagnostic plots of (1) distance from the median location, (2) straight-line displacement between locations, (3) turning angle, and (4) time interval between consecutive points. Particular attention was paid to points with large turning angles ($\gtrapprox 170^\circ$) and excessively high straight-line displacement, especially if antecedent and subsequent points indicated relatively stationary behaviour (Appendix A).

### Historical temperature data and climate change projections

\noindent Rasters of hourly air temperature data were downloaded from the ERA5 database [@hersbach_era5_2023] from the European Center for Medium-range Weather Forecasting server (ECMWF; [www.ecmwf.int](www.ecmwf.int); [https://cds.climate.copernicus.eu](https://cds.climate.copernicus.eu)). Proximal air temperature was estimated for each location by extracting the value from the corresponding raster cell from the temporally nearest raster using the `extract()` function from the `terra` package [v. 1.7-46, @hijmans_terra_2023] for `R` [@r_core_team_r_2024].

We used the the `climatenaR` package [v. 1.0, @burnett_climatenar_2023] for `R` and ClimateNA [v. 7.4.2$;$ @wang_locally_2016; @mahony_global_2022] to obtain projected average monthly temperatures from 2025 to 2100 at a 0.08$^\circ$ spatial resolution. Since the climate projections only provided monthly means and ranges but no measures of variance or distributional assumptions, we used the historical data for western Canada from 1998 to 2023 (extremes included) to estimate the monthly variation in temperature, which we defined as $\sigma^2_T$, the variance at location $\langle x, y \rangle$ in month $m$ for each year (e.g., the variance at coordinates $\langle -119.40, 49.94 \rangle$ in April 2005). We then modeled the estimated variance using a Generalized Additive Model (GAM) for Location and Scale [GAMLS, @rigby_generalized_2005; @stasinopoulos_generalized_2007; section 7.9 in @wood_generalized_2017] using the `mgcv` package for `R` [v. 1.9-1, @wood_generalized_2017]. The linear predictor for the location (i.e., the mean) included smooth terms of: each year's estimated within-pixel monthly mean temperature ($\hat \mu_T$), month ($m$), a two-dimensional smooth of spatial coordinates $\langle x, y \rangle$, and a tensor product interaction term of month and space to allow for seasonal terms to vary smoothly over space. The linear predictor for the scale term, which governs the mean-variance relationship [table 3.1 on p. 104 of @wood_generalized_2017], included smooth terms of the monthly mean temperature, month, and space. We did not include smooth terms of year to avoid unrealistic projections when extrapolating beyond past 2023. The model was thus

\begin{equation}\label{eq:temp-var-model}
\begin{cases}
\sigma^2_T \sim \text{Gamma}(\mu_{\sigma^2_T}, \nu_{\sigma^2_T}) \\
\mathbb E(\sigma^2_T) = \mu_{\sigma^2_T} \\
\mathbb V(\sigma^2_T) = (\mu_{\sigma^2_T})^2 / \nu_{\sigma^2_T} \\
\log(\mu_{\sigma^2}) = \beta_{L,0} + f_{L,1}(\mu_T) + f_{L,2}(m) + f_{L,3}(x, y) + f_{L,4}(x, y, m) \\
\log(\nu_{\sigma^2}) = \beta_{S,0} + f_{S,1}(\mu_T) + f_{S,2}(m) + f_{S,3}(x, y)
\end{cases},
\end{equation}

\noindent where $\mu_{\sigma^2_T}$ and $\nu_{\sigma^2_T}$ indicate the location and scale parameters of the gamma distribution of $\sigma^2_T$, and together they determine the variance of $\sigma^2_T$, indicated as $\mathbb V(\sigma^2_T)$. Functions $f_{L,j}$ and $f_{S,j}$ indicate the $j^\text{th}$ smooth functions for the location and scale parameters, respectively. To ensure the smooth functions of month, $f_{L,2}(m)$ and $f_{S,2}(m)$, joined smoothly between December and January, the terms use cyclic cubic spline bases. The spatial terms used two-dimensional Duchon splines, a generalization of thin-plate regression splines (p. 221 of @wood_generalized_2017). The smoothness parameters were estimated via REstricted Maximum Likelihood [REML$;$ p. 83 of @wood_generalized_2017]. See the Data Availability Statement for additional information on the code used to fit the model.

We simulated hourly variation in future years by assuming hourly temperature followed a normal distribution with mean specified by the monthly `climatenaR` climate projections and variance as specified by the gamma GAMLS. For each month within each year from 2025 to 2100, we simulated hourly weather by including temperatures from the 0.1 to the 0.9 quantiles by increments of 0.1, and we weighted each quantile proportionally to the (normalized) Gaussian probability density for each quantile.

### Resource rasters

\noindent We estimated percent forest cover and distance from water using the temporally static rasters created by @tuanmu_global_2014. We calculated total forest cover by summing the four rasters of evergreen/deciduous needle-leaf trees, evergreen broadleaf trees, deciduous broadleaf trees, and mixed/other trees (raster classes 1-4, respectively). We converted the raster of percent cover of open water (class 12) to a binary raster of pixels with water (cover > 0%) or without water (cover = 0%) and then calculated each pixel's distance from the nearest pixel with water using the `distance()` function from the `terra` package. Finally, we obtained two digital elevation models using the `get_elev_raster()` function from the `elevatr` package [v. 0.99.0, @hollister_elevatr_2023]. We used a raster with a zoom of 6 (a resolution of 0.009$^\circ$) for model fitting and one with a zoom of 3 (a resolution of 0.08$^\circ$) for downloading climate change projections via `climatenaR`. All final rasters and code are available on GitHub (see the Data Availability Statement). For ease of interpretability and comparison with current conditions, we assumed resources would remain constant through to 2100, although we recognize that the spatial distribution of forest cover and open water will likely change throughout the 21^st^ century.

## Estimating mammals' instantaneous speeds

\noindent We modeled each animal's movement using continuous-time movement models [@fleming_fine-scale_2014] via the `ctmm` package [v. 1.2.0, @fleming_ctmm_2023] for `R`. We then estimated each mammal's instantaneous speed at each observed location by applying the `ctmm::speeds()` function on all models with finite speed estimates [415 of 433, @fleming_fine-scale_2014; @noonan_scale-insensitive_2019]. The 18 animals with insufficiently fine sampling to support movement models with finite speed were for one mountain goat, 15 boreal caribou, and two southern mountain caribou (Table \@ref(tab:data-table)).

Since $\texttt{ctmm}\text{'s}$ movement models assume a single moving state with stochastic but non-zero speed [@calabrese_ctmm_2016; @noonan_scale-insensitive_2019], we corrected data-informed speeds so that the minimum instantaneous speed could be 0. We performed this correction by subtracting each model's mean speed while assuming speeds were $\chi^2$-distributed. The function we used is available on GitHub (see the Data Availability Statement). To avoid artifacts due to excessively small, non-zero speeds, we determined whether an animal was moving or not using a $k$-means algorithm with 2 clusters for each species' distribution of detrended speeds. When the algorithm clearly failed to discriminate between states, we estimated the split point using the inflection points in histograms of the detrended speeds (Fig. B1).

## Estimating the effects of temperature on mammals' movement behaviour

\noindent Ambient temperature is only one of the many drivers of mammalian movement behaviour (Fig. \@ref(fig:dags)). Many species alter their movement rates (e.g., movement frequency and speed) daily or seasonally in response in factors such as solar time, photoperiod, forage availability, reproductive cycles, and predator avoidance. Similarly, ambient temperature also fluctuates throughout the day and across seasons. Therefore, estimating the effects of temperature on movement rates requires accounting for how mammals' response to temperature changes with time of day and day of year [Fig. \@ref(fig:dags)A$;$ @peron_periodic_2017; @buderman_time-varying_2018; @leclerc_determinants_2021; @xu_plasticity_2021]. Similarly, mammals' selection strength for resources depends on ambient temperature, since higher temperatures can promote a selection for refuge from heat [e.g., thicker forest cover, higher elevation, proximity to water$;$ @attias_effects_2018; @giroux_activity_2023].

The two following sections detail the statistical framework and models we used to estimate the effect on temperature on the six species' movement behaviour. To assess the importance of including temperature as an explicit covariate (as ooposed to including its effects with time of day and day of year), we fit models with and without smooth effects of temperature and compared the fits of the two sets of models via analyses of deviance (a form of generalized likelihood ratio tests) following the methods of Section 3.3 in @wood_generalized_2017. See Appendix B for additional information.

```{r dags,  message=FALSE, warning=FALSE, fig.cap="Directed Acyclical Graphs (DAGs) assumed for inferring the causal effects of temperature on each species' movement behaviour. (A) Ambient temperature affects mammals' movement rates (i.e. probability of moving, speed when moving, and distance traveled), but temperature is influenced by time of day and day of year. Additionally, the effects of temperature on movement rates depend on time of day and season, since animals may respond to temperatures differently at different times of day and or days of year. Finally, the effect of time of day changes seasonally due to changes in photoperiod. (B) Similarly, habitat selection depends on the availability and selection of resources (forest cover, elevation, and distance from water), but the selection strengh for each resource is conditional on temperature. For example, an animal may avoid forested areas unless it is seeking refuge from extreme temperatures.", fig.height=8, fig.width=20, out.width='\\linewidth'}
library('dplyr')   # for data wrangling
library('ggplot2') # for fancy plots
library('cowplot') # for plots in grids

# movement rates
boxes_a <- tibble(xmin = c(0, 10, 5, 5),
                  xmax = xmin + 4,
                  ymin = c(10, 10, 5, 0),
                  ymax = ymin + 1,
                  fill = c('#BBBBBB80', '#BBBBBB80', '#FF8C00AA', '#FF0000CC'),
                  label = c('Time of day', 'Day of year', 'Movement rates',
                            'Temperature'))

arrows_a <- tibble(id = sort(rep(1:6, 2)),
                   x = c(10, 4, 4, 6, 10, 8, 2, 6, 7, 7, 12, 8),
                   y = c(10.5, 10.5, 10, 6, 10, 6, 10, 1, 1, 5, 10, 1))

p_a <-
  ggplot() +
  geom_rect(aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
            boxes_a, fill = boxes_a$fill, color = 'black') +
  geom_path(aes(x, y, group = id), arrows_a, linewidth = 1,
            arrow = arrow(type = 'closed')) +
  geom_label(aes(x = (xmin + xmax) / 2, y = (ymin + ymax) / 2,
                 label = label), boxes_a, fill = 'transparent',
             fontface = 'bold', label.size = 0, size = 5) +
  theme_void() +
  theme(legend.position = 'none')

# habitat selection
boxes_b <- tibble(xmin = c(5, 0, 5, 10, 5),
                  xmax = xmin + 4,
                  ymin = c(10, 5, 5, 5, 0),
                  ymax = ymin + 1,
                  fill = c('#FF8C00AA', rep('#BBBBBB80', 3), '#FF0000CC'),
                  label = c('Habitat selection', 'Forest cover',
                            'Elevation', 'Distance from water',
                            'Temperature'))

arrows_b <- tibble(id = sort(rep(1:6, 2)),
                   x = c(2, 6, 7, 7, 12, 8, 6, 2, 7, 7, 8, 12),
                   y = c(6, 10, 6, 10, 6, 10, 1, 5, 1, 5, 1, 5))

p_b <-
  ggplot() +
  geom_rect(aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax),
            boxes_b, fill = boxes_b$fill, color = 'black') +
  geom_path(aes(x, y, group = id), arrows_b, linewidth = 1,
            arrow = arrow(type = 'closed')) +
  geom_label(aes(x = (xmin + xmax) / 2, y = (ymin + ymax) / 2,
                 label = label), boxes_b, fill = 'transparent',
             fontface = 'bold', label.size = 0, size = 5) +
  theme_void() +
  theme(legend.position = 'none')

plot_grid(p_a, p_b, labels = 'AUTO', nrow = 1)
```

### Effects of temperature on movement rates

\noindent We estimated the effects of temperature on mammals' instantaneous movement state (moving or not) and speed when moving using two Hierarchical Generalized Additive Models [HGAMs$;$ @pedersen_hierarchical_2019 and Appendix B] with the `mgcv` package for `R`. The first HGAM estimated the probability that an animal was moving, $P(M)$, with a binomial family of distributions and logit link function. The second HGAM estimated an animal's speed when moving with a gamma family of distributions and log link function. We fit the models with fast Restricted Maximum Likelihood (`'fREML'`) and discretized covariates (`discrete = TRUE`) to optimize computational efficiency with no appreciable losses to model performance [Appendix B$;$ @wood_generalized_2015; @wood_generalized_2017-1; @li_faster_2020]. Together, the binomial HGAM and the gamma HGAM inform us on an animal's long-term average speed, since it is the product of the probability of moving and its average speed when moving.

The HGAMs (equations \@ref(eq:p-moving-model) and \@ref(eq:speed-model)) included fixed-effect intercepts for each species ($\beta_\texttt s$), random intercepts for each animal ($Z_\texttt{a}$), and species-level `by` smooths that allowed independent smoothness parameters for each species [model I in Figure 4 of @pedersen_hierarchical_2019]. The `by` smooths accounted for trends in time of day (in Pacific Daylight Time; `tod_pdt`), day of year (`doy`), and temperature (`temp_c`). To account for the cyclicity of time of day and day of year, the smooth terms used cyclic cubic splines [p. 202 of @wood_generalized_2017]. The models also had three tensor product interaction terms `by` each species: (1) day of year and time of day, (2) temperature and time of day, and (3) temperature and day of year. These three terms accounted for smooth changes in: (1) daily behaviour across day of year, (2) the response to temperature over time of day (e.g., changes in nocturnality), and (3) the response to temperature over day of year (e.g., the timing of molting, migration, and hybernation). Finally, two smooth terms of log-transformed sampling interval (`dt`; hours) corrected for biases in speed estimates arising from irregular GPS sampling intervals, since longer intervals result in lower speed estimates [@nathan_big-data_2022; @denicola_are_2025]. A global smooth term of $\log(\texttt{dt})$ accounted for the overall effect of sampling interval, while a factor-smooth interaction term (`bs = 'fs'`) of $\log(\texttt{dt})$ and species accounted for species-level deviations from the global term while assuming a common smoothness parameter across species [model GS in Figure 4 of @pedersen_hierarchical_2019]. Formally, the model for movement state $M$, with $M = 0$ indicating no movement and $M = 1$ indicating movement, was

\begin{equation}\label{eq:p-moving-model}
\begin{cases}
M \sim \text{Bin}(p) \\
\mathbb E(M) = p \\
\mathbb V(M) = p (1-p) \\
\begin{aligned}
\text{logit}(p) = & \beta_\texttt{s} + Z_\texttt{a} + f_{1,\texttt{s}}(\texttt{tod\_pdt}) + f_{2,\texttt s}(\texttt{doy}) + f_{3,\texttt s}(\texttt{temp\_c}) + \\
& f_{4,\texttt s}(\texttt{doy}, \texttt{tod\_pdt}) + f_{5, \texttt s}(\texttt{temp\_c}, \texttt{tod\_pdt}) + f_{6, \texttt s}(\texttt{temp\_c}, \texttt{doy}) + \\
& f_7(\log(\texttt{dt})) + f_{8,\texttt s}(\log(\texttt{dt}))
\end{aligned}
\end{cases},
\end{equation}

\noindent while the model for movement speed when moving (i.e., $M = 1$, indicated with $S$) was

\begin{equation}\label{eq:speed-model}
\begin{cases}
S \sim \text{Gamma}(\mu_S, \nu_S) \\
\mathbb E(S) = \mu_S \\
\mathbb V(S) = \mu_S^2 / \nu_S \\
\begin{aligned}
\text{log}(\mu_S) = & \beta_\texttt{s} + Z_\texttt{a} + f_{1,\texttt{s}}(\texttt{tod\_pdt}) + f_{2,\texttt s}(\texttt{doy}) + f_{3,\texttt s}(\texttt{temp\_c}) + \\
& f_{4,\texttt s}(\texttt{doy}, \texttt{tod\_pdt}) + f_{5, \texttt s}(\texttt{temp\_c}, \texttt{tod\_pdt}) + f_{6, \texttt s}(\texttt{temp\_c}, \texttt{doy}) + \\
& f_7(\log(\texttt{dt})) + f_{8,\texttt s}(\log(\texttt{dt}))
\end{aligned}
\end{cases}.
\end{equation}

\noindent In both models, $\beta_\texttt{s}$ indicates a fixed intercept for species \texttt{s}, $Z_\texttt a$ indicates a Gaussian random effect for animal \texttt{a} (of species \texttt{s}), $f_{j,\texttt{s}}$ indicates the $j^{\text{th}}$ smooth function for species \texttt{s}, and functions with two variables indicate tensor product interaction terms. The model code used to fit the models is available in Appendix B.

### Effects of temperature on habitat selection

\noindent We estimated the effects of temperature on each species' selection for percent forest cover (`forest_perc`), elevation (`elevation_m`, in meters), and distance from water (`dist_water_m`, in meters) by fitting a Hierarchical Resource Selection Function (HRSF) for each species [@mccabe_resource_2021]. We fit each HRSF using an HGAM with a Poisson family of distributions and log link function [Appendix B$;$ @aarts_estimating_2008]. After removing non-resident individuals (Table B1), we accounted for the spatiotemporal autocorrelation in the telemetry locations by weighting each point based on the telemetry's Autocorrelated Kernel Density Estimate [@fleming_new_2017; @noonan_comprehensive_2019; @alston_mitigating_2022] to produce estimates of second-order habitat selection [@johnson_comparison_1980]. Quadrature points were determined using the raster cells in each animal's 99.9% AKDE percentile and given a weight of 1. The number of quadrature locations greatly outnumbered the number of observed locations (Fig. B12), especially after accounting for the AKDE weights (Fig. B13).

Each species' model had the same structure:

\begin{equation}\label{eq:hrsf}
\begin{cases}
O \sim \text{Pois}(\lambda) \\
\mathbb E(O) = \mathbb V(O) = \lambda \\
\begin{aligned}
\text{log}(\lambda) = & f_{1}(\texttt{forest\_perc}) + f_{2}(\texttt{elevation\_m}) + f_{3}(\texttt{dist\_water\_m}) + \\
& Z_\texttt a + f_{4, \texttt{a}}(\texttt{forest\_perc}) + f_{5, \texttt{a}}(\texttt{elevation\_m}) + f_{6, \texttt{a}}(\texttt{dist\_water\_m}) + \\
& f_{7}(\texttt{forest\_perc}, \texttt{temp\_c}) + f_{8}(\texttt{elevation\_m}, \texttt{temp\_c}) + \\
& f_{9}(\texttt{dist\_water\_m}, \texttt{temp\_c}) + f_{10}(\texttt{temp\_c}) + f_{11,\texttt a}(\texttt{temp\_c}))
\end{aligned}
\end{cases},
\end{equation}

\noindent where $O$ indicates whether an animal was observed ($O = 1$) or not ($O = 0$), and the species-level indices are omitted for readability, but each term in the model can be assumed to be species-specific. Smooth effects of percent forest cover (\texttt{forest\_perc}), elevation (\texttt{elevation\_m}, in meters), and distance to water (\texttt{dist\_water\_m}, in meters) accounted for the species-level selection strength for each resource. A Gaussian random effect for each individual animal ($Z_\texttt a$) corrected for uneven sampling across individuals, while factor-smooth interaction terms for each animal ($f_{j,\texttt a}$) accounted for animal-level resource selection [i.e., individual-level deviations from the species-level estimate$;$ @jeltsch_need_2025]. Tensor product interaction terms of the three resources and temperature (\texttt{temp\_c}) estimated the smooth change in resource selection at different temperatures. Finally, marginal smooth terms of temperature and factor-smooth interaction terms of temperature and animal accounted for species- and individual-level sampling biases at different temperatures (e.g., sampling more during warm periods).

```{r, eval=FALSE}
library('mgcv')
library('purrr')
x <- list.files('H:/GitHub/bc-mammals-temperature/models/', 'rsf-', include.dirs = FALSE, full.names = T)
x <- x[grepl('2024-10', x)]
map_int(x, \(f) readRDS(f)$iter)
```

# Results

\noindent Of the GPS fixes with finite speed estimates, 2.6% had temperatures lower than $-20^\circ$C, while 6.5% had temperatures above $20^\circ$C, and temperature ranges differed across species (Table \@ref(tab:hgam-summary), Fig. B2). Sampling interval affected estimates of probability as well of as speed when moving (Fig. B8). Consequently, we present all results while predicting specifically for one-hour sampling intervals. At $0^\circ$C, species differed in estimated mean probabilities of moving ($\hat P(M = 1)$; range: 0.05 -- 0.31), mean speed when moving ($\hat {\mathbb E}(S|M=1)$; range: 0.42 -- 2.67 km/h), and mean distance traveled (i.e., $\hat P(M) \times \hat {\mathbb E}(S|M=1)$, range: 0.04 -- 0.61 km/h; Table \@ref(tab:hgam-summary)). Grizzly bears had the lowest movement frequency ($\hat P(M) \approx 0.05$), while wolves and cougars moved most often ($\hat P(M) \ge 0.22$). Mountain goats and southern mountain caribou moved the slowest ($\hat{\mathbb E}(S|M = 1) \approx 0.43$ km/h), while wolves had the highest mean speed when moving ($\hat{\mathbb E}(S|M = 1) \approx 2.67$ km/h). Consequently, at $0^\circ$C, wolves traveled an average of $0.22 \times 2.67~\text{km/h} \approx 0.6$ km/h; 2.5 to 16.7 times further than other species.

\tiny

```{r hgam-summary}
setwd('~/GitHub/bc-mammals-temperature')
library('mgcv')
library('dplyr')
library('purrr')
library('ctmm') #' for `%#%`
source('analysis/figures/default-ggplot-theme.R')

d <- readRDS('data/hgam-speed-data.rds')

get_perc <- function(bools) {
  perc <- round(mean(bools) * 100, 1)
  out <- as.character(perc)
  if(grepl('\\.', out)) {
    out <- paste0(out, '')
  } else {
    out <- paste0(out, '.0')
  }
  
  if(perc < 10) out <- paste0(' ', out)
  
  return(out)
}

get_int <- function(.m) {
  newd <- mutate(.m$model[1:7, - 1], species = SPECIES, temp_c = 0, dt = 1)
  predict(.m, type = 'response', newdata = newd,
          terms = c('(Intercept)', 'species',
                    's(temp_c)', paste0('s(temp_c):species', SPECIES),
                    's(log(dt))', 's(log(dt),species)'))
}

intercepts <- tibble(
  Species = SPECIES,
  p = get_int(readRDS('models/binomial-gam.rds')),
  s = 'km/h' %#% get_int(readRDS('models/gamma-gam.rds')),
  d = p * s) %>%
  rename('P(M=1|T=0^\\circ C)' = p,
         'E(S|M=1,T=0^\\circ C)' = s,
         'E(D|T=0^\\circ C)' = d) %>%
  mutate(Species = COMMON_NAMES) %>%
  arrange(Species) %>%
  rename_with(\(.x) paste0('$', .x, '$'), ! Species) %>%
  rename_with(\(.x) gsub('\\|', '\\\\vert ', .x)) %>%
  rename_with(\(.x) gsub('P', '\\\\hat{P}', .x)) %>%
  rename_with(\(.x) gsub('E', '\\\\hat{\\\\mathbb E}', .x))

if(FALSE) {
  # visualize the individual estimates
  layout(1:3)
  hist(intercepts$`P(M=1)`); hist(intercepts$`E(S|M=1)`); hist(intercepts$`E(D)`)
  layout(1)
  
  # find differences when accounting for temperature
  intercepts %>%
    transmute(Species,
              p = round(`P(M=1|T)` - `P(M=1)`, 2),
              s = round(`E(S|M=1,T)` - `E(S|M=1)`, 2),
              d = round(`E(D|T)` - `E(D)`, 2))
  
  # find difference in distance traveled, relative to furthest distance
  intercepts %>%
    arrange(desc(`E(D)`)) %>%
    mutate(displ_wolf = `E(D)`[grepl('Canis lupus', Species)] / `E(D)`,
           displ_wolf_t = `E(D|T)`[grepl('Canis lupus', Species)] / `E(D|T)`)
  
  # find difference in distance traveled, relative to furthest distance
  round(range(max(intercepts$`E(D|T)`) / intercepts$`E(D|T)`[- which.max(intercepts$`E(D|T)`)]), 1)
}

options(knitr.kable.NA = '') # leave NAs blank

# species-level proportions
d %>%
  rename(Species = species) %>%
  group_by(Species) %>%
  summarize('$n$' = n(),
            'T<-20\\textdegree{}C (%)' = get_perc(temp_c < -20),
            'T>+20\\textdegree{}C (%)' = get_perc(temp_c > +20)) %>%
  mutate(Species = COMMON_NAMES[map_int(Species,
                                        \(.s) which(SPECIES == .s))]) %>%
  full_join(intercepts, by = 'Species') %>%
  arrange(Species) %>% # arrange alphabetically by common name
  mutate(Species = if_else(Species == 'Caribou (southern mountain)',
                           'Caribou (s. mountain)', Species)) %>%
  # add overall proportions
  bind_rows(
    d %>%
      summarize(Species = 'Total',
                '$n$' = n(),
                'T<-20\\textdegree{}C (%)' = get_perc(temp_c < -20),
                'T>+20\\textdegree{}C (%)' = get_perc(temp_c > +20))) %>%
  knitr::kable(format = 'markdown', digits = 2, format.args = list(big.mark = ','), caption = "Summary statistics for each species' GPS fixes with finite speed estimates, namely: the number fixes after data cleaning ($n$), the percentage of fixes with temperature ($T$) below $-20^\\circ$C and above $20^\\circ$C, the estimated mean probability of moving ($\\hat P(M=1)$), the mean speed when moving ($\\hat{\\mathbb E}(S|M=1)$; km/h), and the mean distance travelled ($\\hat P(M=1) \\times \\hat{\\mathbb E}(S|M=1) = \\hat{\\mathbb E}(D)$; km/h), for a sampling interval of 1 hour and a temperature $T$ of $0^\\circ$C.")
```

\normalsize

Across all species, Relative Selection Strength (RSS) was weakest for forest cover and strongest for elevation. At temperatures near 0$^\circ$C, wolves selected for forest cover ($\gtrapprox$ 50%), elevations near 1 km, and distances from water < 5 km; elk selected for intermediate forest cover ($\approx$ 50%), elevations between 1 and 2 km, and distances from water of 10-15 km; mountain goats selected for sparse forest cover (< 25%), elevations near 1.5 km, and distances from water < 5 km; cougars selected for dense forest cover (> 75%), an elevation of ~ 1 km, and distances from water < 7.5 km; boreal caribou selected for forest cover between 50% and 75%, elevations near 500 m, and distances from water < 10 km; southern mountain caribou selected for dense forest cover, elevations near 2 km, and distances from water $\lessapprox$ 5 km; and grizzly bears selected for relatively sparse forest cover (25-50%), elevation between 1 and 2 km, and distances from water < 3 km.

There was relatively strong agreement between models with and without temperature (Figs. B3, and B14), but including temperature always resulted in better fits (all p-values $< 2.2\times10^{-16}$; all $\Delta$AIC $\le$ -342; Appendix B). Accounting for temperature even resulted in a simpler HRSF for mountain goats (lower model degrees of freedom) that fit the data better (lower deviance), and hence no test was necessary to show that the inclusion of temperature produced a better fit.

## Effects of temperature on movement rates

```{r, eval=FALSE}
library(mgcv)
# to  get deviance explained
summary(readRDS('models/binomial-gam.rds'), re.test = FALSE)$dev.expl
summary(readRDS('models/gamma-gam.rds'), re.test = FALSE)$dev.expl
```

\noindent Species' changes in movement rates to temperature varied in both direction and magnitude (Figs. \@ref(fig:dist), B4-B6), even after accounting for differences in daily and seasonal activity (e.g., sleeping, migration, hibernation; Figs. B4-B6). Smooth interaction terms were well-behaved and indicated clear shifts in activity over time of day and day of year for all species. The models had good in-sample prediction (Fig. B7) and explained reasonably high proportions of the deviance [79.3% for the gamma model and 10.7% for the binomial model, which is relatively high for a binomial model with binary responses: see ch. 11 of @mcelreath_statistical_2020]. All species altered their daily and seasonal movement behaviour to changes in temperature (Fig. \@ref(fig:dist)). The clearest example of this was cougars. In late spring (June 1^st^), they moved from evening to early morning if temperatures were below $20^\circ$C, but if temperatures were above 20$^\circ$C they moved mostly between 3:00 and 6:00 AM. Throughout the year, they tended to move more when it was colder, but what they perceived as "colder" was relative to the time of year. All species' estimated probability of moving and speed when moving decreased with sampling intervals above 1 hour, except for cougars' speed, although the estimated trends were highly uncertain (Fig. B8). Uncertainties around the estimated effects were generally higher at extreme temperatures due to lower data availability (Figs. B4A, B5A, and B6A).

```{r dist, fig.cap="\\textbf{Temperature is a strong driver of how far and when mammals travel.} The fill indicates the effects of temperature on the relative change in distance travelled (probability of moving times mean speed when moving) over time of day on June $1^{\\text{st}}$ (\\textbf{A}) and day of year at 12:00 PDT (\\textbf{B}). Predictions in the surface plots extend to 10% of the range away from each datum. The color bar is on the $\\log_2$ scale to help visualize patterns in doubling, and values are capped to $2^{\\pm 2}$ for ease of readability."}
# not specifying dt and doy for A and time for B because change is relative
knitr::include_graphics('../figures/distance.png')
```

## Effects of temperature on habitat selection

Species' RSS was generally strongest for elevation and weakest for forest cover, but RSS depended significantly on temperature for all species (all p-values $< 2.2\times10^{-16}$; Fig. \@ref(fig:hrsfs)). Changes in RSS with temperature were strongest for elevation and generally weakest for distance from water, but there were no common trends across all species for any of the three resources. All species, with the exception of cougars, exhibited clear temperature-dependent shifts in their preference for forest cover. At higher temperatures, wolves relaxed their preference for forested areas, while mountain goats relaxed their preference open areas (cover < 50%). As temperatures warmed, elk and boreal caribou shifted towards more forest cover closer to 50%, while southern mountain caribou and grizzly bears selected for areas with 50% forest cover or less. All species shifted elevationally with temperature, although boreal caribou ha a much sharper change in RSS across elevation. Elk, mountain goats, and cougars moved to higher elevations with temperature, while wolves, southern mountain caribou, and grizzly bears moved to lower elevations. Wolves, elk, and southern mountain caribou moved closer to water with temperature, while mountain goats, cougars, and grizzly bears moved somewhat further away from water but remained mainly within 5-10 of water. As with movement rates, estimated RSS was generally most uncertain at extreme temperatures, for which data was scarcer (Fig. B15).

```{r hrsfs, fig.cap="\\textbf{Mammals' habitat selection depends on ambient temperature.} Estimated relative selection strength (RSS) for forest cover (\\%), elevation (km), and distance from water (km) as a function of temperature. The grey contours indicate the extent of each species' observed data. RSS values were re-centered and capped to $2^{\\pm 2}$ to improve readability."}
knitr::include_graphics('../figures/hrsf-surface-plots.png')
```

## Predicted changes in movement behaviour during the 21^st^ century

\noindent Predicted changes in movement rates with future climate change varied across species in both magnitude and direction, but worse SSPs always corresponded to greater absolute changes (Fig. \@ref(fig:t-dist)). Additionally, species that were predicted to move less often did not necessarily have lower speeds when moving, and vice versa (Figs. B9 and B10). Estimated changes in average distance travaled were negligible for boreal caribou, and grizzly bears, although both species showed seasonal changes in seasonal movement rates. As temperatures warmed, boreal caribou moved further in winter, spring, and fall but less in summer, while grizzly bears showed a clear shift towards earlier emergence from hibernation (Fig. B4) and greater movement earlier in the year but less movement in early fall. Southern mountain caribou and mountain goats are projected to travel further by 2100, although the estimates for southern mountain caribou varied greatly over space (Fig. \@ref(fig:s-dist)). Cougars, elk, and wolves were projected to move less by 2100, with cougars showing as much as a 24% decrease in mean yearly distance travelled.

Absolute relative changes in average yearly distance travelled were small under the best-case SSP (0-4% change in 2100 relative to 2025). Under the worst-case SSP, absolute changes by 2100 (relative to 2025) ranged from ~2% (grizzly bears) to ~24% (cougars). Projected changes in 2100 varied spatially due to spatial heterogeneity in climate change projections (Fig. \@ref(fig:s-dist)). Again, absolute changes were generally greatest under worse SSPs, but the direction of change at each location also varied across SSPs (most visible in cougars).

```{r, eval=FALSE, echo=FALSE}
library('dplyr')

readRDS('../data/cc-hgam-projections.rds') %>%
  group_by(species) %>%
  filter(grepl('Best', scenario), year > 2095) %>%
  summarise(mean = mean(d_median)) %>%
  mutate(mean = abs(mean - 1) * 100) %>%
  arrange(mean)

readRDS('../data/cc-hgam-projections.rds') %>%
  group_by(species) %>%
  filter(grepl('Worst', scenario), year > 2095) %>%
  summarise(mean = mean(d_median)) %>%
  mutate(mean = abs(mean - 1) * 100) %>%
  arrange(mean)
```

```{r t-dist, fig.cap="\\textbf{Species will alter their movement rates differently in response to climate change, but worse climate-change scenarios will result in the greatest change.} Bold lines indicate the median change in distance travelled (probability of moving times speed when moving) due to predicted changes in temperature within each species' observed extent. Shaded areas indicate the $95^\\text{th}$ and $5^\\text{th}$ percentiles. Changes are relative to the mean predicted distance travelled at each location in 2025, averaged across the four Shared Socioeconomic Pathways (SSPs). Values > 1 indicate an increase, while values < 1 indicate a decrease. The projections only account for changes in movement frequency and speed, and they ignore changes in physiology or movement costs."}
knitr::include_graphics('../figures/distance-travelled-local-cc-predictions.png')
```

```{r s-dist, fig.cap="\\textbf{Climate change will impact each species' movement rates differently, but changes will also vary spatially.} The color of each pixel indicates the predicted changes in distance traveled in 2100 at that pixel, relative to the value in 2025, averaged across all four scenarios. Values < 1 indicate a decrease, and values > 1 indicate an increase. For ease of readability, the color bar is on the $\\log_2$ scale to help visualize patterns in doubling). The predictions only account for the predicted temperature throughout the areas and ignore environmental factors such as terrain slope, soil type, and forest density. All maps extend to each species' observed extent (Fig. 1) and are shown in the BC Albers Equal Area Conic projection (EPSG:3005)."}
if(FALSE) range(readRDS('../data/cc-hgam-projections-local-2100.rds')$d)
knitr::include_graphics('../figures/local-distance-2100.png')
```

Median RSS was projected to decrease over time within the each species' observed range, but, again, changes were stronger under worse SSPs (Fig. \@ref(fig:t-rss-cc)). Decreases were most pronounced in areas with the lowest RSS and most severe for elk, mountain goats, pumas, and southern mountain caribou. Changes for boreal wolves and caribou were relatively negligible. Elk, cougars, and grizzly bears were predicted to increase their selection strength for top-RSS areas, and elk, mountain goats, cougars, and southern mountain caribou were predicted to further decrease their selection for areas with low RSS. Unsurprisingly, the change in RSS between 2025 and 2100 also varied spatially for all species (Fig. \@ref(fig:s-rss-cc)). Overall, RSS decreased throughout most of each species' current range, although elk, cougars, and bears were predicted to increase their selection for higher-altitude habitats. Still, none of the species were projected to increase RSS throughout their habitat (\@ref(fig:density-hrsfs)).

```{r, eval=FALSE}
library('dplyr')

readRDS('../data/cc-hrsf-projections.rds') %>%
  group_by(lab) %>%
  filter(grepl('Best', scenario), year > 2095) %>%
  summarise(mean = mean(l_median)) %>%
  mutate(mean = (mean - 1) * 100,
         decreased = mean < 0) %>%
  arrange(mean)

readRDS('../data/cc-hrsf-projections.rds') %>%
  group_by(lab) %>%
  filter(grepl('Worst', scenario), year > 2095) %>%
  summarise(mean = mean(l_median)) %>%
  mutate(mean = (mean - 1) * 100,
         decreased = mean < 0) %>%
  arrange(mean)
```

```{r t-rss-cc, fig.cap="\\textbf{Species will alter their habitat selection differently in response to climate change, but worse climate-change scenarios will result in the greatest change.} Bold lines indicate the change in median RSS due to predicted changes in temperature within each species' observed extent. Shaded areas indicate the $95^\\text{th}$ and $5^\\text{th}$ percentiles in change in RSS. Values > 1 indicate an increase, while values < 1 indicate a decrease. Changes are relative to each location's mean RSS in 2025, averaged across the four Shared Socioeconomic Pathways (SSPs)."}
knitr::include_graphics('../figures/rss-local-cc-predictions.png')
```

```{r s-rss-cc, fig.cap="\\textbf{Climate change will impact each species' relative selection strength (RSS) differently.} The color scale indicates the predicted changes in RSS in 2100, relative to each location's average RSS in 2025 across all four scenarios (i.e., not relative to other pixels). Values < 1 indicate a decrease and values > 1 indicate an increase. For ease of readability, the color bar is on the $\\log_2$ scale to help visualize patterns in doubling, and values are capped to 0.8 and 1.25 ($\\approx 2^{\\pm 0.322}$; original data ranged 0.71 to 1.93). All maps extend to each species' observed extent (Fig. 1) and are shown in the BC Albers Equal Area Conic projection (EPSG:3005)."}
if(FALSE) range(readRDS('../data/cc-hrsf-projections-local-2100.rds')$l)
knitr::include_graphics('../figures/local-rss-2100.png')
```

```{r density-hrsfs, fig.cap="\\textbf{Climate change will cause species to decrease their selection strength for their current habitats, but worse climate change scenarios will have the greatest impact.} The density plots indicate each species' change in RSS in 2100 for their current habitat (Fig. 8), relative to each location's RSS in 2025. Values < 1 indicate a decrease and values > 1 indicate an increase. For ease of readability, values > 1.3 were changed to 1.3 (original maximum: 1.93)."}
knitr::include_graphics('../figures/local-rss-2100-density.png')
```

# Discussion

<!-- to do: address any questions presented in the introduction -->

\noindent We have demonstrated that temperature is an important driver of how and where large mammals move, and that mammals alter their seasonal and daily cycles in movement behaviour in response to changes in temperature. However, predicting mammals' responses to climate change remains a challenge, as habitats warm rapidly and mammals are exposed to increasingly novel and extreme conditions [@ipcc_climate_2023; @diffenbaugh_changes_2013; @botero_evolutionary_2015]. We leveraged the flexibility and interptetability of GAMs to estimate the (nonlinear) responses  of terrestrial mammals to temperature. In particular, tensor product interaction terms were crucial for estimating smooth, nonlinear changes in daily and seasonal trends with temperature. By allowing interaction terms to be smooth bivariate functions, we were able to quantify changes in movement behaviour without the need to discretize time into distinct windows (e.g., day/night and seasons). We were thus able to present changes using relatively simple and interpretable surface plots (Figs. \@ref(fig:dist) and \@ref(fig:hrsfs)) that conveyed detailed and nuanced estimates of change. This framework was essential for estimating how mammals behave in extreme conditions for which data are scarce.

As temperatures warm, mammals' risk of heperthermia increases nonlinearly [@sherwood_adaptability_2010], especially for large-bodied species [@alston_temperature_2020; @dyer_travel_2023; @verzuh_behavioural_2023]. The recent increase in frequency and duration of extreme-temperature events [@yao_emergence_2022; @ipcc_climate_2023; @zhang_increased_2023; @bunnell_global_2011; @kienzle_has_2018] have forced many mammals towards increasingly atypical behaviours with long-term consequences, ranging from changes in the behaviour and fitness of individuals [@brivio_seeking_2024; @cunningham_opportunity_2021] to mass die-offs [@ameca_y_juarez_natural_2012]. A species' ability to respond to changing temperature and phenology depends mainly on the its exposure, sensitivity, and adaptability to changes, and growing evidence suggests that many mammals in western Canada will struggle to respond due limitations in all three factors [@ameca_y_juarez_natural_2012; @diffenbaugh_changes_2013]. Firstly, exposure to warming temperatures is widespread throughout the area, and warming is expected to accelerate over the coming decades [@ipcc_climate_2023; @diffenbaugh_changes_2013; @bunnell_global_2011; @kienzle_has_2018; @eum_potential_2023]. Secondly, large-bodied mammals are particularly sensitive to high heat [@dyer_travel_2023], but small-bodied mammals are also affected [@ratnayake_forecasting_2019; @krebs_impact_2019]. Finally, species' adaptability is tested by the speed of climate change [@diffenbaugh_changes_2013] and the rigidity of many species' photoperiod-dependent phenology [@walker_global_2019].

<!-- complex response from each species -->

Our results suggest that climate change will cause mammals to alter their seasonal movement behaviour, but not all species will respond similarly. For example, hotter temperatures caused boreal caribou to travel longer distances in fall, winter, and spring but less in summer, mirroring the findings of @stien_congruent_2012, @leclerc_determinants_2021, and @lessard_local_2025. The increase in movement rates during the colder seasons are likely partly due to shallower snow depth that results in greater mobility [@pedersen_quantifying_2021], but rising temperatures during snowy seasons also increase the chances of rain-on-snow events, which limit forage availability and increase the ungulates' need to search for food [@stien_congruent_2012; @berger_climate_2018; @mezzini_how_2025]. In contrast, the reduced movement rates during warmer summers are likely mainly due to caribou searching for shelter from the heat due to ungulates' elevated risk of hyperthermia [@alston_temperature_2020; @verzuh_behavioural_2023]. The effects of extreme temperatures are exacerbated by phenological mismatches with seasonal photoperiod [@walker_global_2019], including the timing of molting and reproduction. Earlier growth seasons in boreal and arctic regions have resulted in lower calf birth and survival [@post_climate_2008], while the lengthening of the growth season has allowed moose (*Alces alces*) and deer (*Odocoileus* spp.) to encroach on boreal caribou habitat, along with increased density of coyotes (*Canis latrans*), cougars, and wolves [@barber_potential_2018; @demars_incorporating_2023]. Thus, rising temperatures affect more than each individual species' movement behaviour; they have complex and interconnected effects on an entire community and its trophic structure.

<!-- complex response from community -->

Our results suggest that rising temperatures will have similar effects on boreal wolves. Warmer temperatures caused wolves to travel further throughout the year, but, similarly to boreal caribou, they moved substantially less at temperatures above 25$^\circ$C in summer. At temperatures above 20$^\circ$, both boreal caribou and wolves tended to move less during the day and more between 17:00 and 24:00. This synchroniciy in movement patterns is likely to increase encounters between the two species, particularly when coupled with increasing human disturbances, since wolves leverage seismic lines and other anthropogenic linear features (e.g., roads) to reduce movement costs while increasing the chances of encountering prey [@whittington_caribou_2011; @dickie_faster_2017; @dickie_resource_2022]. Additionally, caribou that attempt to reduce predation risk from wolves by avoiding wolf habitat may risk increasing predation pressure from bears [@leblond_caribou_2016] and other encroaching predators [@demars_incorporating_2023]. As temperatures rise and allow new competitors and predators to encroach on boreal caribou habitat [@barber_potential_2018; @demars_incorporating_2023; @labadie_global_2023], climate change will have complex conseuqences not only for individual species but for entire communities and their trophic interactions.

<!-- focus on habitat selection using changes in elevational preference of elk, goats, and cougars as the main example -->

Considerations about changes in trophic interactions leads to an important caveat about the results we present. The estimated effects of temperature on movement behaviour cannot be fully attributed to physiological responses to changes in temperature alone, since other aspects of habitats' seasonal phenology are (nonlinearly) correlated with temperature. For example, mountain goats' reduced movement rates at temperatures near 0$^\circ$C in winter may be due to increased movement difficulty, since melting snow and rain-on-snow events affect the energetic costs of movement [@white_population_2025] and encounter rates with predators [@sullender_defining_2023]. However, milder temperatures can also increase plant growth, which, in turn, allows goats to spend less time searching for forage [@white_mountain_2025]. Therefore, the figure \@ref(fig:dist) illustrates an estimate of the total effect of temperature on each species movement rates, but it does not explicitly account for energetic costs. Similarly, species' changes in habitat selection do not explicitly account for any changes in physiological or energetic costs. Both mountain goats and elk selected for higher elevation as temperatures warmed, but our models did not explicitly account for differences in forage availability at different altitudes. 

Forage quality and availability is often a limiting factor for mammals' ability to adapt to warming temperatures by moving to higher altitudes. Plants are slower to arrive in and establish in new habitats than mammals, and the advance of herbivores can further limit plants' ability to establish [@speed_elevational_2012; @diffenbaugh_changes_2013]. Consequently, mammals that move to higher elevations may be forced to spend more time foraging [@mezzini_how_2025], which will increase their energetic expenditure as well as their chances of encountering predators (including cougars and grizzly bears) or competitors [@kohl_prey_2019; @martinez-garcia_how_2020; @torrez-herrera_monkeys_2020; @smith_densitydependent_2023]. Additionally, plants at high elevations may be have weaker defenses against herbivory and be more susceptible to overgrazing [@callis-duehl_community-level_2017]. The scarcity and susceptibility of forage may thus limit herbivores' ability to shift elevationally, particularly if predation rates remain relatively unchanged or increase. Furthermore, the physical upper limit to elevation can cause individuals to become trapped . If local peaks become unsuitable habitat, and moving to nearby higher peaks requires traveling across low-quality and high-risk habitat (Figure \@ref(fig:s-rss-cc)), habitat fragmentation may become too excessive to move across patches or alternative ranges [@white_mountain_2025]. Translocating animals to locations with higher peaks may help avoid such a scenario, but the success of relocations can be highly species-dependent, and attempts are not always successful [@ranc_memory_2022; @white_mountain_2025].

Changes in mammals' seasonal movement behaviour are also likely to affect the timing and frequency of human-wildlife interactions [@abrahms_climate_2023; @weststrate_how_2024]. Since heat affects mammals' sleep quality and likelihood to enter torpor [@mortlock_sleep_2024; @fjelldal_nightly_2021; @wells_life_2022], future decades may see increased levels of incidents with bears that struggle to enter or remain in hibernation [@johnson_human_2018]. The risk is further increased when bears' are unable to meet their increased energetic requirements through foraging or hunting. Projected increases in park attendance due to rising temperatures and human population density in Western Canada are expected to further increase frequency of human-wildlife interactions [@weststrate_how_2024].

## Consequences for conservation

Species' adaptability to rising temperatures is challenged by the aforementioned symultaneous, multifarious, and interconnected stressors caused by climate change, since responding to many concurrent changes at once is particularly difficult [@diffenbaugh_changes_2013; @polazzo_measuring_2024]. Locations may thus not be able to support species and population sizes they supported historically, and species may thus not select for historical geograpical ranges in the future. It is therefore crucial for conservationists and other decision-makers to distinguish between a species' ideal environmental space [or E space, *sensu* @matthiopoulos_defining_2022], and its best available geographic space [or G space, *sensu* @matthiopoulos_defining_2022]. Accelerating multufarious change in species' movement behaviour and energetic costs require conservation measures to be proactive and anticipate future changes, even when future conditions are substantially different from historical conditions and historical data may not be available. To this end, the framework presented by @polazzo_measuring_2024 for estimating species' responses to multifarious change becomes essential, particularly when accounting for energetic and fitness costs, as argued by @cunningham_opportunity_2021.

As of December 2024, only 13.8% of terrestrial Canada was within protected areas or other conserved areas [@environment_and_climate_change_canada_canadian_2025], so rapid action is necessary to protect and additional 16.2% of Canada's land by 2030 in accordance with Kunming-Montreal Global Biodiversity Framework [i.e., the "30 by 30 initiative"$;$ @convention_on_biological_diversity_154_2022]. However, the choice of what habitats to protect will require careful consideration, since protected areas should support species not only in present conditions but also as species' needs and selection change over the coming decades [@simmons_tough_2021]. As anthropogenic activity increasingly alters habitats and community structures [@sih_evolution_2011; @tucker_moving_2018; @rosenthal_impact_2022; @rice_conspicuous_2022], protecting biodiversity and the habitats it depends on will require widespread and collaboration with local stakeholders, especially Indigenous Peoples, to ensure that all decisions are culturally sound and respect Treaties [@turner_its_2009; @desjardins_looking_2020; @wong_towards_2020; @hessami_indigenizing_2021; @falardeau_biophysical_2022; @lamb_braiding_2023]. Understanding the consequences of climate change in mammalian movement behaviour is a first step towards proactively responding to how mammals will respond to human-induced rapid environmental change [@sih_evolution_2011; @williams_range_2018]. However, a better understanding of such consequences will require a more holistic approach that includes careful data collection, model design, and interpretation and application of results. 

## Study strengths and limitations

Our results demonstrate that mammals respond to changes in temperature by altering how and where they move in complex and nonlinear ways (Figs. \@ref(fig:dist) and \@ref(fig:hrsfs)). Hierarchical Generalized Additive Models were crucial in producing such results. The hierarchical approach us to produce statistically sound population-level estimates by accounting for differences in behaviour and data availability across individuals [@pedersen_hierarchical_2019; @muff_accounting_2020; @mccabe_resource_2021; @mortlock_sleep_2024; @jeltsch_need_2025; @silva_too_2025], while the flexibility of GAMs estimated mammals' changes in movement behaviour without imposing rigid assumptions about the shape of the responses [@simpson_method_2025; @simpson_modelling_2018]. Still, GAMs' flexibility and complexity can be a frustrating limitation if used too generously by inexperienced analysts. We suggest choosing the basis size (`k`) for each smooth term carefully. While penalized splines and REML can help avoid unruly smooth terms that would result in questionable estimates the penalty terms can struggle to restrict model complexity when datasets are particularly large [@wood_generalized_2017; @wood_generalized_2017-1].

Despite the statistical soundness of the models, estimating mammals' response to projected climate change remained a challenge because climate change projections included mean monthly temperatures but no measures of the full distribution of temperature. Since mammals' responses to temperature are nonlinear, accurate estimates of the effects of climate change require estimates of the full distribution of temperatures that mammals will be exposed to -- estimated means alone are not sufficient. This is because, since the responses to temperature are nonlinear, the mean response across the distribution of temperatures is not the same as the response to mean temperature. This inequality is often referred to as Jensen's inequality or the fallacy of the average [@jensen_sur_1906; @denny_performance_2019], and it is a main motivator for Generalized Linear Models and GAMs [@denny_fallacy_2017; @simpson_method_2025]. We approximated of the distribution of monthly temperatures by assuming monthly temperatures were normally distributed after estimating monthly variance in temperature, but more work is necessary on estimating changes in climate beyond montly mean values.

A second advantage of our approach is the use of continous-time estimates of speed and distance traveled that are less impacted by irregular sampling rates than straight-line displacement [@noonan_scale-insensitive_2019]. Still, our results indicate that the movement models fit by `ctmm` still suffer from two crucial issues. Firstly, although the models allow speeds to vary stochastically over time, they assume non-zero speeds and do not currently allow for multiple movement states [@augermethe_guide_2021]. Secondly, while continuous-time estimates of speed are less sensitive to sampling rates than straight-line displacement estimates, our models indicate that longer sampling intervals still cause speed and travel distance to be underestimated [Fig. B8$;$ also see @denicola_are_2025]. Shorter sampling intervals may help overcome this bias [@noonan_scale-insensitive_2019; @nathan_big-data_2022; @pease_ecological_2024]. To account for the occasional missed GPS fix, we suggest setting sampling intervals to five or more times smaller than the animal's expected directional persistence [@noonan_scale-insensitive_2019]. Still, excessively high sampling can cause the animal's movement to be confounded with GPS error [@fleming_comprehensive_2020], so we suggest calibrating GPS error whenever possible.

The final (and arguably most evident) limitation of our study was the use of temporally static estimates of forest cover. While the use of a single raster produced results and forecasts that are relatively simpler and easier to interpret, species' selection to estimated forest cover was relatively weak. Future studies should account for temporal variation in forest cover, especially given the growing severity of forest fires in Canada [@zurowski_summer_2023] as well widespread tree harvesting and its impact on wildlife [@betts_forest_2022; @lochhead_linking_2022]. Additionally, a finer spatial scale may help detect changes in forest edge selection with greater precision. Future work would also benefit from accounting for other important forest properties, such as age, tree composition, and canopy height. However, accounting for more variables requires careful consideration about what values such variables should take when estimating changes in movement behaviour under future conditions.

## Considerations for future work

***HERE***

We have presented a multi-species analysis of the effects of temperature on mammalian movement rates and habitat selection in hopes that other researchers can leverage this framework and models to expand our understanding of how temperature affects the movement behaviour of other species, including smaller mammals, more elusive species, and non-mammal animals.

large mammals give clear responses, but they are also already studied most often

More work is necessary on quantifying interspecific responses to temperature, including the effects of temperature on predation rates [but see: @cunningham_opportunity_2021; @glass_trade-off_2021; @brivio_seeking_2024]. The increase in intensity and frequency of extreme heat events [@bunnell_global_2011; @yao_emergence_2022] will likely also impact the occurrence and timing of hibernation [@wells_life_2022] and migration or seasonal range expansions [@carbeck_adaptation_2022; @morley_spatiotemporal_2021; @malpeli_ungulate_2022]. However, not all species may be able to adapt at the current rate of climate change [@williams_range_2018; @hetem_responses_2014], especially since landscape changes will likely depend not only on the direct effect of temperature but also on cascading changes in the availability and unpredictability of resources [@mclellan_effect_2015; @pigeon_drivers_2016; @mezzini_how_2025].

Future work should explore the effects of temperature on movement behaviour while accounting for finer-scale and species specific variables that were not accounted for in this study. Examples of these include temporally dynamic measures of forest type and age, canopy density, competitive pressures, forage availability, and predator avoidance, or environmental stochasticity. However, many of these data not available, so we also suggest that more work be done on quantifying such measures using spatiotemporally dynamic models and sufficiently fine resolutions. ***...*** animals in the study are generalists; we need more work on specialists (i.e., species without wide species distributions) and smaller species, but they can be harder to track.

changes in the phenology of plants, fire, ice, or mammalian physiology (e.g., moulting, fat storage) or behaviour (e.g., migration, food caching), other than as direct responses to temperature. 

# Author contributions {-}

\noindent SM performed the data cleaning, ran the analyses, and wrote the manuscript. CHF wrote code for estimating instantaneous movement speeds. MJN conceived of the project idea and supervised SM throughout the project. All other authors contributed telemetry data and reviewed the interpretation of the results for their species of interest. KH and SD contributed substantially to manuscript review. All authors contributed to reviewing the manuscript.

\clearpage <!-- to prevent figures from floating to the references -->

\newpage <!-- place references on a separate page -->

# References {-}

\hangparas{1em}{1} <!-- paragraphs hanging by width equal to font height -->
